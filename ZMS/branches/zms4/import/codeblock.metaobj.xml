<?xml version="1.0" encoding="utf-8"?>

<dictionary>
  <item key="key"><![CDATA[codeblock]]></item>
  <item key="value" type="dictionary">
    <dictionary>
      <item key="__obj_attrs__" type="list">
        <list>
          <item type="dictionary">
            <dictionary>
              <item key="custom"><![CDATA[icon-code]]></item>
              <item key="id"><![CDATA[icon_clazz]]></item>
              <item key="mandatory" type="int">0</item>
              <item key="multilang" type="int">0</item>
              <item key="name"><![CDATA[Icon (Class)]]></item>
              <item key="repetitive" type="int">0</item>
              <item key="type"><![CDATA[constant]]></item>
            </dictionary>
          </item>
          <item type="dictionary">
            <dictionary>
              <item key="id"><![CDATA[text]]></item>
              <item key="mandatory" type="int">0</item>
              <item key="multilang" type="int">0</item>
              <item key="name"><![CDATA[Code]]></item>
              <item key="repetitive" type="int">0</item>
              <item key="type"><![CDATA[text]]></item>
            </dictionary>
          </item>
          <item type="dictionary">
            <dictionary>
              <item key="id"><![CDATA[codeeditor]]></item>
              <item key="mandatory" type="int">0</item>
              <item key="multilang" type="int">0</item>
              <item key="name"><![CDATA[<!--
++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
+++ Ajax.org Cloud9 Editor
+++ http://ace.ajax.org
+++ @see $ZMS_HOME/plugins/www/ace.ajax.org
++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
-->
<style>
  .ace_editor.fullScreen {
      height: 100% !important;
      width: 100% !important;
      border: 0;
      margin: 0;
      position: fixed !important;
      top: 0;
      bottom: 0;
      left: -350px;
      right: 0;
      z-index: 10;
      overflow: hidden;
  }
</style>
<div id="editor" style="min-height:520px;height:92%;width:100%;border:1px solid #ccc;border-radius:4px;margin-bottom:1em">ace editor text</div>
<script type="text/javascript" charset="UTF-8" src="/++resource++zms_/ace.ajax.org/ace.js"></script>
<script type="text/javascript">
$(function(){
	if ($("textarea#text").length == 0) {
		$("#editor").hide();
	}
	else {
    var dom = require("ace/lib/dom");
    // add command to all new editor instances
    require("ace/commands/default_commands").commands.push({
      name: "Toggle Fullscreen",
      bindKey: "F10",
      exec: function(editor) {
        var fullScreen = dom.toggleCssClass(document.body, "fullScreen")
        dom.setCssClass(editor.container, "fullScreen", fullScreen)
        editor.setAutoScrollEditorIntoView(!fullScreen)
        editor.resize()
      }
    });
    // @see https://github.com/ajaxorg/ace/wiki/Embedding---API
		// $("textarea#text").hide();
		$("#tr_text").hide();
		editor = ace.edit("editor");
		var value = $("textarea#text").val();
		var content_type = $("input#content_type").val();
		if (typeof content_type == "undefined" || content_type == null || content_type == '' || content_type == 'text/x-unknown-content-type') {
			var absolute_url = $("span#absolute_url").text();
			var id = absolute_url.substr(absolute_url.lastIndexOf("/")+1);
			if (id.endsWith(".css")) {
				content_type = "text/css";
			}
			else if (id.endsWith(".less")) {
				content_type = "text/less";
			}
			else if (id.endsWith(".js")) {
				content_type = "text/javascript";
			}
			else {
				content_type = "text/html";
			}
		}
		if (value.indexOf("<html") == 0) {
			content_type = "text/html";
		}
		if (value.indexOf("<?xml") == 0 || value.indexOf("tal:") >= 0) {
			content_type = "text/xml";
		}
		if (value.indexOf("#!/usr/bin/python") == 0 || value.indexOf("## Script (Python)") == 0) {
			content_type = "python";
		}
		var mode = "text";
		if (content_type == "text/html") {
			mode = "html";
		}
		else if (content_type == "text/css" || content_type == "application/css" || content_type == "application/x-css") {
			mode = "css";
		}
		else if (content_type == "text/less") {
			mode = "less";
		}
		else if (content_type == "text/javascript" || content_type == "application/javascript" || content_type == "application/x-javascript") {
			mode = "javascript";
		}
		else if (content_type == "text/xml") {
			mode = "xml";
		}
		else if (content_type == "python") {
			mode = 'python';
		}
		editor.setTheme("ace/theme/chrome");
		editor.getSession().setMode('ace/mode/'+mode);
		editor.getSession().setValue(value);
		editor.getSession().on("change",function() {
				$("textarea#text").val(editor.getSession().getValue()).change();
			});
	}
});
</script>]]>
              </item>
              <item key="repetitive" type="int">0</item>
              <item key="type"><![CDATA[interface]]></item>
            </dictionary>
          </item>
          <item type="dictionary">
            <dictionary>
              <item key="default"><![CDATA[0]]></item>
              <item key="id"><![CDATA[onlythirdview]]></item>
              <item key="mandatory" type="int">0</item>
              <item key="multilang" type="int">0</item>
              <item key="name"><![CDATA[Nur Drittsicht]]></item>
              <item key="repetitive" type="int">0</item>
              <item key="type"><![CDATA[boolean]]></item>
            </dictionary>
          </item>
          <item type="dictionary">
            <dictionary>
              <item key="custom"><![CDATA[<!-- codeblock.standard_html -->

<tal:block tal:define="global zmscontext options/zmscontext">
<pre tal:condition="python:zmscontext.attr('onlythirdview')==1 and request.get('URL').find('/manage')>0" tal:content="python:zmscontext.attr('text')">CODE</pre>
<tal:block tal:condition="python:zmscontext.attr('onlythirdview')==0 or request.get('URL').find('/manage')<0" tal:content="structure python:zmscontext.attr('text')">CODE</tal:block>
</tal:block>

<!-- /codeblock.standard_html -->]]>
              </item>
              <item key="id"><![CDATA[standard_html]]></item>
              <item key="mandatory" type="int">0</item>
              <item key="multilang" type="int">0</item>
              <item key="name"><![CDATA[Template: HTML-Block]]></item>
              <item key="repetitive" type="int">0</item>
              <item key="type"><![CDATA[zpt]]></item>
            </dictionary>
          </item>
        </list>
      </item>
      <item key="access" type="dictionary">
        <dictionary>
          <item key="delete_custom"></item>
          <item key="delete_deny" type="list">
            <list>
              <item></item>
              <item></item>
              <item></item>
              <item></item>
              <item></item>
              <item></item>
              <item></item>
              <item></item>
              <item></item>
              <item></item>
              <item></item>
              <item></item>
              <item></item>
              <item></item>
              <item></item>
              <item></item>
              <item></item>
              <item></item>
              <item></item>
              <item></item>
              <item></item>
              <item></item>
              <item></item>
              <item></item>
              <item></item>
              <item></item>
              <item></item>
              <item></item>
              <item></item>
              <item></item>
              <item></item>
              <item></item>
              <item></item>
              <item></item>
              <item></item>
            </list>
          </item>
          <item key="insert_custom"><![CDATA[{$}]]></item>
          <item key="insert_deny" type="list">
            <list>
              <item></item>
              <item></item>
              <item></item>
              <item></item>
              <item></item>
              <item></item>
              <item></item>
              <item></item>
              <item></item>
              <item></item>
              <item></item>
              <item></item>
              <item></item>
              <item></item>
              <item></item>
              <item></item>
              <item></item>
              <item></item>
              <item></item>
              <item></item>
              <item></item>
              <item></item>
              <item></item>
              <item></item>
              <item></item>
              <item></item>
              <item></item>
              <item></item>
              <item></item>
              <item></item>
              <item></item>
              <item></item>
              <item></item>
              <item></item>
              <item></item>
            </list>
          </item>
        </dictionary>
      </item>
      <item key="enabled" type="int">1</item>
      <item key="id"><![CDATA[codeblock]]></item>
      <item key="name"><![CDATA[HTML-Block]]></item>
      <item key="package"><![CDATA[com.zms.foundation]]></item>
      <item key="revision"><![CDATA[1.0.0]]></item>
      <item key="type"><![CDATA[ZMSObject]]></item>
    </dictionary>
  </item>
</dictionary>