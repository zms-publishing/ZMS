<?xml version="1.0" encoding="utf-8"?>
<list>
<item type="dictionary"><dictionary>
<item key="dtml"><![CDATA[<!-- BO bodyContentZMSCustom_BulletinBoardRatings -->

  <h2><dtml-var "getTitlealt(REQUEST)"></h2>
  <p class="description"><dtml-var "_.len(getObjProperty(getMetaobj(meta_id)['attrs'][0]['id'],REQUEST))"> <dtml-var "getLangStr('ATTR_RECORDS',lang)"></p>

<!-- EO bodyContentZMSCustom_BulletinBoardRatings -->]]></item>
<item key="enabled" type="int">0</item>
<item key="key"><![CDATA[BulletinBoardRatings]]></item>
<item key="value" type="dictionary"><dictionary>
<item key="__obj_attrs__" type="list"><list>
<item type="dictionary"><dictionary>
<item key="custom" type="int">0</item>
<item key="default"></item>
<item key="id"><![CDATA[records]]></item>
<item key="keys" type="list"><list>
</list>
</item>
<item key="mandatory" type="int">1</item>
<item key="multilang" type="int">0</item>
<item key="name"><![CDATA[records]]></item>
<item key="repetitive" type="int">0</item>
<item key="type"><![CDATA[list]]></item>
</dictionary>
</item>
<item type="dictionary"><dictionary>
<item key="custom" type="int">0</item>
<item key="default"></item>
<item key="id"><![CDATA[bbrId]]></item>
<item key="keys" type="list"><list>
</list>
</item>
<item key="mandatory" type="int">1</item>
<item key="multilang" type="int">0</item>
<item key="name"><![CDATA[Id]]></item>
<item key="repetitive" type="int">0</item>
<item key="type"><![CDATA[identifier]]></item>
</dictionary>
</item>
<item type="dictionary"><dictionary>
<item key="custom" type="int">1</item>
<item key="default"></item>
<item key="id"><![CDATA[bbrMsg]]></item>
<item key="keys" type="list"><list>
</list>
</item>
<item key="mandatory" type="int">0</item>
<item key="multilang" type="int">0</item>
<item key="name"><![CDATA[Msg]]></item>
<item key="repetitive" type="int">0</item>
<item key="type"><![CDATA[BulletinBoardMessages]]></item>
</dictionary>
</item>
<item type="dictionary"><dictionary>
<item key="custom" type="int">1</item>
<item key="default"></item>
<item key="id"><![CDATA[bbrRate]]></item>
<item key="keys" type="list"><list>
<item><![CDATA[1]]></item>
<item><![CDATA[2]]></item>
<item><![CDATA[3]]></item>
<item><![CDATA[4]]></item>
<item><![CDATA[5]]></item>
</list>
</item>
<item key="mandatory" type="int">0</item>
<item key="multilang" type="int">0</item>
<item key="name"><![CDATA[Rate]]></item>
<item key="repetitive" type="int">0</item>
<item key="type"><![CDATA[select]]></item>
</dictionary>
</item>
<item type="dictionary"><dictionary>
<item key="custom" type="int">1</item>
<item key="default"></item>
<item key="id"><![CDATA[bbrExpl]]></item>
<item key="keys" type="list"><list>
</list>
</item>
<item key="mandatory" type="int">0</item>
<item key="multilang" type="int">0</item>
<item key="name"><![CDATA[Explanation]]></item>
<item key="repetitive" type="int">0</item>
<item key="type"><![CDATA[text]]></item>
</dictionary>
</item>
<item type="dictionary"><dictionary>
<item key="custom" type="int">1</item>
<item key="default"></item>
<item key="id"><![CDATA[bbrDateTime]]></item>
<item key="keys" type="list"><list>
</list>
</item>
<item key="mandatory" type="int">0</item>
<item key="multilang" type="int">0</item>
<item key="name"><![CDATA[Date/Time]]></item>
<item key="repetitive" type="int">0</item>
<item key="type"><![CDATA[datetime]]></item>
</dictionary>
</item>
<item type="dictionary"><dictionary>
<item key="custom" type="file">
<data content_type="image/gif" filename="stars-0-5.gif" type="file">47494638396140000c00d50000bdbf9ea2a374afb0889999669f9f70a6a679acac83b3b38cb9b996bfbfa0c6c6a9ccccb2d2d2bcd9d9c5dbdbc9dfdfcfe5e5d9ecece2eeeee5f2f2ecf9f9f5d1cfb6e7e5d8f9f8f4f7c758edab30bf9e63e39516ad7720af823be6d9c4cfb58dffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002c0000000040000c000006ff40907048bc3888c82372685c0a290fa7b021ad120101e925a05c56045286410a1950acd68ec6e2740000520180bd342020ce04628196563a1b704b011702124b6e1682440d0910094b130614637d421a1d991c1b19029e9f9e700e01a19f0187a4070807ac05132005acb20705540906ac0951561f1a9c18194212728648176f02154b7a067c4811b808674413070a961f80c0200ec5c35dc3ca205f1743150c420b93436211200d05ee4210057896209b19c10087428a43ff861413b208c401792010bc4a4745088386f700713855a14bc551cab2083c4691c82404f11e0e51b880c08347f74058e8c0e18305398b881df3540ec430010e86019806cd4003406809200989a58082b54a960070f02084e39000e2b871115221009d63bb18c47b92a0c03c02101798b957a1e6102512ba0853521649d669431a3e40388fee9020003b</data></item>
<item key="default"></item>
<item key="id"><![CDATA[stars-0-5]]></item>
<item key="keys" type="list"><list>
</list>
</item>
<item key="mandatory" type="int">0</item>
<item key="multilang" type="int">0</item>
<item key="name"><![CDATA[stars-0-5]]></item>
<item key="repetitive" type="int">0</item>
<item key="type"><![CDATA[resource]]></item>
</dictionary>
</item>
<item type="dictionary"><dictionary>
<item key="custom" type="file">
<data content_type="image/gif" filename="stars-1-0.gif" type="file">47494638396140000c00b30f00fefefdb4b690c4c5a7e19212a6a87be7e6dad4d4bdbd9b64aa7727f6f6f1eeeee5f6bc46ceb38adfddccbb8633ffffff21f9040100000f002c0000000040000c000004fff0c94993a058153ccbe60f5024e0d390652a15880226c1050a018a15c49711ae5a260704038413d8260a5a634630003834a30fa4400c1ccf8a40d030700c60ef8d2be84d00b5da34d40822108e8503ee3804028480287fbfe747787d7e4e027c7d4d00857d0d5920000c560b92039475018c0099990677029a9a9c790a9f0030a2a4309e3e0006910b94085ea99a169e8901a399342e38987b5ebd9a0a048c6bac0e9494432b359905520f1698d213024ebac50f60099b4e6bd107575603071db87f061f0ae97816620f5c06c45d280205f2e9d053096f07407012003420604f9e35090dee342880474c228249eef4c063240681232a582c4b00c98505350f2e8a4890f701861a1cdeb4e58846308b3c332a042e39536049826c1234442b0053848b85184e842cd0686851091100003b</data></item>
<item key="default"></item>
<item key="id"><![CDATA[stars-1-0]]></item>
<item key="keys" type="list"><list>
</list>
</item>
<item key="mandatory" type="int">0</item>
<item key="multilang" type="int">0</item>
<item key="name"><![CDATA[stars-1-0]]></item>
<item key="repetitive" type="int">0</item>
<item key="type"><![CDATA[resource]]></item>
</dictionary>
</item>
<item type="dictionary"><dictionary>
<item key="custom" type="file">
<data content_type="image/gif" filename="stars-1-5.gif" type="file">47494638396140000c00b30f00c7c6a8fefefdb2b48de39414a3a577e7e7dac29d60d7d5bfae7925f4c152f7f6f1efeee5d4b887e1deceb78940ffffff21f9040100000f002c0000000040000c000004fff0c94915a0b8143c359741a17c4f3392a8d420cbb718d7070867266cdc42e0e9a71808c66745cbcd1a32c2a136990198bdc902317004303f43e2c03978b9194003d0a204048b6234d00022108e8403eea8bfa906817eaf1709087c7f070100807c0400847c0d5724010c5403090903950e069795038301077a8901a1a19e7a0ba2a10a7ba6a7a9893d9d549395085c2f910c84a033ab8a2d05028ca1bf5c0504c1013a8c510fb09a034212056fcf0b4f12169c164812009c84ca0f5e0aa383cb0f3f03d30306132be96807380b070d7fd84d0d074af9270005faf1ac2d53f0c6c00f382000c0a127a09b0a3df104254454ad94844fad084041210d9a02482d335e3828532c863e1ca98a142b176ec7394427f49579d5601b887f0fe63592b06083820633991568d180878a111a763e48ca2102003b</data></item>
<item key="default"></item>
<item key="id"><![CDATA[stars-1-5]]></item>
<item key="keys" type="list"><list>
</list>
</item>
<item key="mandatory" type="int">0</item>
<item key="multilang" type="int">0</item>
<item key="name"><![CDATA[stars-1-5]]></item>
<item key="repetitive" type="int">0</item>
<item key="type"><![CDATA[resource]]></item>
</dictionary>
</item>
<item type="dictionary"><dictionary>
<item key="custom" type="file">
<data content_type="image/gif" filename="stars-2-0.gif" type="file">47494638396140000c00b30f00e39515c9c8abfefdfdad9a63b1b38bc7a46ce7e5d8d8d9c5aa7726b88635f6f5f0e6d8c2f6bd48f0ede3cfb285ffffff21f9040100000f002c0000000040000c000004fff0c94955a0d82c3c8de1926028e07390652a19480336c35006049a111f07bb6aa9140807688148f0280dda01a4147068015b0f8900249c48470220c40402870b26193e866ab5e943b01820de0946a29818cc8b0c007d40e8e3147e8103070234810403018581842902055b000c79005676059293950909048a02a0a0077e0da1a0807da5a6808a3d85559a7a1b305b9a45a034aa8b2e060484a0bd4bc1a10dbe58ae0191955d0f6d959b3c16bf16390f60a1d7120727a28d6a3f56555613ce45561b0f0d07bd356013600783db280106f1eb516a0f0a73050a6e09420428b26060822ea37cb15bb22640a224a924f489e2298d1a165d043868b10f128f05092b0a4870980315895ead4c0cf8c00a4b3c338e345010312be58a0d0a0c9811c1ab9ab693068e3dd029544204003b</data></item>
<item key="default"></item>
<item key="id"><![CDATA[stars-2-0]]></item>
<item key="keys" type="list"><list>
</list>
</item>
<item key="mandatory" type="int">0</item>
<item key="multilang" type="int">0</item>
<item key="name"><![CDATA[stars-2-0]]></item>
<item key="repetitive" type="int">0</item>
<item key="type"><![CDATA[resource]]></item>
</dictionary>
</item>
<item type="dictionary"><dictionary>
<item key="custom" type="file">
<data content_type="image/gif" filename="stars-2-5.gif" type="file">47494638396140000c00b30f00e49514c6c5a7af9860fdfdfcb0b28bc3a575e7e4d5ac7624d6d7c2d2b889be8831f7f6f1f5ba43e5d6baefece2ffffff21f9040100000f002c0000000040000c000004fff0c94957a0d8343c8de3d2602ce08390652a19c7c739425126049a110608bb2ab8148704a87128f0268e8220c709101083262160eb511c0780207a552812174ce28b78051081e36350ab59d70dc161ae60280ede3b9d01c0e7e7596004838402504e8483020103885350290340000c9500970a7294969802020a970c0d030308840ea4a90ba7a9a4ab8c3d03449b97071b0e5e9c0a05a4097300a34e1f064fa9c465c7a90ec56fb2a098422b59970005283f07a28d4c0f67a901065c0827a4e35c563f0077a00213b3bf094c30ea356713e00886e32869f9080e54de3c5830c79a9c76037d0968a0300c9103ff069559136011c0412e065199e2e60d8b680b347c7d8021000511190f7c6d183885c432582696b084994f4d0911dcd66878e060d4950d0b1ae414312ce7831147c351f0706e4204003b</data></item>
<item key="default"></item>
<item key="id"><![CDATA[stars-2-5]]></item>
<item key="keys" type="list"><list>
</list>
</item>
<item key="mandatory" type="int">0</item>
<item key="multilang" type="int">0</item>
<item key="name"><![CDATA[stars-2-5]]></item>
<item key="repetitive" type="int">0</item>
<item key="type"><![CDATA[resource]]></item>
</dictionary>
</item>
<item type="dictionary"><dictionary>
<item key="custom" type="file">
<data content_type="image/gif" filename="stars-3-0.gif" type="file">47494638396140000c00b30f00e39515ae9962cac5a7c7a266fdfdfbb0b189e9e5d7ab7827ba8736d8d8c5f5bc46e5d7c2cdb082f5f3edefece2ffffff21f9040100000f002c0000000040000c000004fff0c9499ba0d82c3cd7e60f6134e09310653a1987033641500e01c91985f106ae5a36830303b438207a1407e2f0c1080a27ce5380f2711c0700a23a6930108021e68b102705090152422834dcd6d02270a823144b0422b0342a0046467d597882058701274f878c01548b05685c1c045f000a98009a7b080397995a077c9f7f9b01050e04aaaa6f87a9abaa919320040284a54c0f0ea39946aa96bd083a3827aac40fc4ab0e50b325b5609a612b01d15a3d40d5084d92aa921209c504e0cd3f0ca19b1dd4465a1f069e755a66680989e0360206f409060236560d4b06c030c2c6963683626c1d10b06089985a8e1c2cea71a85f243871585c08c1a0c50320473124141920a1e307803574c9fa1640c71b2a2cd7a410d12484065d0b26dd6cb040c704020b5c18f039210189a13a53718800003b</data></item>
<item key="default"></item>
<item key="id"><![CDATA[stars-3-0]]></item>
<item key="keys" type="list"><list>
</list>
</item>
<item key="mandatory" type="int">0</item>
<item key="multilang" type="int">0</item>
<item key="name"><![CDATA[stars-3-0]]></item>
<item key="repetitive" type="int">0</item>
<item key="type"><![CDATA[resource]]></item>
</dictionary>
</item>
<item type="dictionary"><dictionary>
<item key="custom" type="file">
<data content_type="image/gif" filename="stars-3-5.gif" type="file">47494638396140000c00b30f00fbfaf8cbab78b2955acdc5a4f0ebdfa97726b1b28ae99812b28338e5ddcbcd8716ecb03dc58f37f8c95adbd3bbffffff21f9040100000f002c0000000040000c000004fff0c949c1a098243cd3e60f9000e033966857102021086520b05c227cd99ca2405004a0448141a310180507483620610686e6ae8538209c134280a10062b60c2fc5b61814250003413d0dd90a88e102894008e2f0c5025ec717f4717577710a07068788874d508a27253d550b0d0d079576080107920b950a05020c9a0d9c070a82a40b04006987aaabaf51588f0e050a92a5490f2ea17a0743ab0155a3a5082c0e085c071a064a6b23abceb23c0e8595611d0295c4343dd5070c4a125bb604038e0e0eafe8d23c010a9e8508d8be55e01236a605df62010ba60e09d24930e340808372ec4a108823008000386806c071201193045a05ccc5b910c2071146343714a58192304846343e58b82876cfe2031f1f5ce84880c9494195b12eea982202879b0d0404665102e06005a300319c20a0ca48530c1100003b</data></item>
<item key="default"></item>
<item key="id"><![CDATA[stars-3-5]]></item>
<item key="keys" type="list"><list>
</list>
</item>
<item key="mandatory" type="int">0</item>
<item key="multilang" type="int">0</item>
<item key="name"><![CDATA[stars-3-5]]></item>
<item key="repetitive" type="int">0</item>
<item key="type"><![CDATA[resource]]></item>
</dictionary>
</item>
<item type="dictionary"><dictionary>
<item key="custom" type="file">
<data content_type="image/gif" filename="stars-4-0.gif" type="file">47494638396140000c00b30f00fbfbf8c8a163b39459d0c7a8a87523f0ebe0b28135ea9811e3d9c4b0b188c48f39f8c757efae35cf8918cdaf80ffffff21f9040100000f002c0000000040000c000004fff0c949c1a0b8203cd1e60f8014e0830065da112457084119082d86185f46ab2910100e1082a0a84d0a0a1cc80144610689819397311c0c5349c1a16804315cc59782083414390920516053430881c1406428087339ddc060e0e77304047d7b027a757b06098b51168c09273d0e560c0b0b0798068601079597070d9a0a9d0b0c98679aa696a60704026c00b1b28d3c16060d95a0041b2fa37dad0ab19307a5a00624370a950c0d400f6d27b1d0593d030d98a06371d8a12d3ed7980a17120e9ca7014e0852b11ed4920dcdd7021d02adb7685a6674076213016604e00568314083801152de3ca33350001e3503f0a89bf325228101379c85f85124c09c0f8b3aa44449e0ae44818b6a989028e0b1c58d180f987c78b1e38603271179d132b1838a883400343c4b7864830823474da47950f059812c059e728800003b</data></item>
<item key="default"></item>
<item key="id"><![CDATA[stars-4-0]]></item>
<item key="keys" type="list"><list>
</list>
</item>
<item key="mandatory" type="int">0</item>
<item key="multilang" type="int">0</item>
<item key="name"><![CDATA[stars-4-0]]></item>
<item key="repetitive" type="int">0</item>
<item key="type"><![CDATA[resource]]></item>
</dictionary>
</item>
<item type="dictionary"><dictionary>
<item key="custom" type="file">
<data content_type="image/gif" filename="stars-4-5.gif" type="file">47494638396140000c00b30f00c7a267faf8f4b59151dccaaaab7725efe9dcea9812b28339c99035cdb185f5c454cd8716e4dac6edac35b5b690ffffff21f9040100000f002c0000000040000c000004fff0c949c3a0b8303cd9e64fc014e0c30465da1124570840090828371c5f26b42a180084046810e44d5e840b0791ac51120287b347291c0c87e9a38058248498040201a610110063e8a09052430c01618e68300f78c261de68e8f17b7c0d7b07028404757785790b0d030e900e27290109570d0a0a069b8b8d999b0600850806980d9b0b86040699a79b86579b0a01b4905a1c16049e060b495b7b9f0668b496aca70b0724440b0ac707170c888d010592b73e030ba0641344db00353fda9b084a0f02e30602033537cc22936f950bbdda02ddab7c091f0500bdabdc241c58c0640180043500344835a0da351f7bc0c93920e10701000c80ac93402409833d60400280b452a8851c1a0e1e3d74e12b4402165b04d0e07800cc4b7e3251dc4028e1e6968b35e2a82901af82862decaa6c106184e98301393892f030a540815b1100003b</data></item>
<item key="default"></item>
<item key="id"><![CDATA[stars-4-5]]></item>
<item key="keys" type="list"><list>
</list>
</item>
<item key="mandatory" type="int">0</item>
<item key="multilang" type="int">0</item>
<item key="name"><![CDATA[stars-4-5]]></item>
<item key="repetitive" type="int">0</item>
<item key="type"><![CDATA[resource]]></item>
</dictionary>
</item>
<item type="dictionary"><dictionary>
<item key="custom" type="file">
<data content_type="image/gif" filename="stars-5-0.gif" type="file">47494638396140000c00b30f00c49f6afbf8f4a77426b78f53dcc9adeb9811e7dac8c68e35b18037ceb080f7c655f2eadef2b033cf8817dd9f38ffffff21f9040100000f002c0000000040000c000004fff0c94903a178193ccde64f602ce0430465da0924b70c40090c2867205f26e42a17008204c82038b4282fc4859308d6280904e0d943220a08ea639138348498ee014c31001a075e68803daa440304a2c83808e4f13982e1b8cbe502020e0c7a0379747a0887070a077f0027290151050c0a0a05998a309597990d8a079d0c9f71030e0597a4050286a89e9a533d16080d96050d02172fa20aa445019357beb808243783beb9423707b7ac9155160d9905631d6c9fc6123fd499074b0f0900d55f3504d9b8095a92090db90d0e03d8acb5e01266a002d664000ef00d00b4f097cb0b8d2adce64c1970871b813b0408c801f350d78d20dc80180120e703431a00371cb951b14017b7262416cc68712386b81d125e1cbcb14ec2c30d0ba49c638150048f001ab6448bb941841ba326d4103866808a07761100003b</data></item>
<item key="default"></item>
<item key="id"><![CDATA[stars-5-0]]></item>
<item key="keys" type="list"><list>
</list>
</item>
<item key="mandatory" type="int">0</item>
<item key="multilang" type="int">0</item>
<item key="name"><![CDATA[stars-5-0]]></item>
<item key="repetitive" type="int">0</item>
<item key="type"><![CDATA[resource]]></item>
</dictionary>
</item>
<item type="dictionary"><dictionary>
<item key="custom" type="file">
<data content_type="image/gif" filename="ico_rating.gif" type="file">47494638396112001000b30000aa7727e19212bb8633bd9b64f6bc46f6f6f1ceb38afefefdd4d4bdeeeee5e7e6dadfddccc4c5a7ffffff00000000000021f9040100000d002c0000000012001000000443b0c949abbdf8b27c15e0d60018e0940081008a002010822b0c97811278a0cf1872133a00828310e87424ce20850ad0382d9a4895f1241bb64466b1a828baa5b0581201003b</data></item>
<item key="default"></item>
<item key="id"><![CDATA[icon]]></item>
<item key="keys" type="list"><list>
</list>
</item>
<item key="mandatory" type="int">0</item>
<item key="multilang" type="int">0</item>
<item key="name"><![CDATA[icon]]></item>
<item key="repetitive" type="int">0</item>
<item key="type"><![CDATA[resource]]></item>
</dictionary>
</item>
</list>
</item>
<item key="access" type="dictionary"><dictionary>
<item key="edit" type="list"><list>
<item><![CDATA[ZMSAdministrator]]></item>
<item><![CDATA[ZMSAuthor]]></item>
<item><![CDATA[ZMSEditor]]></item>
</list>
</item>
<item key="insert" type="list"><list>
<item><![CDATA[ZMSAdministrator]]></item>
<item><![CDATA[ZMSAuthor]]></item>
<item><![CDATA[ZMSEditor]]></item>
</list>
</item>
</dictionary>
</item>
<item key="acquired" type="int">0</item>
<item key="name"><![CDATA[Ratings]]></item>
<item key="package"><![CDATA[com.zms.discussions]]></item>
<item key="type"><![CDATA[ZMSRecordSet]]></item>
</dictionary>
</item>
</dictionary>
</item>
<item type="dictionary"><dictionary>
<item key="dtml"></item>
<item key="enabled" type="int">1</item>
<item key="key"><![CDATA[com.zms.discussions]]></item>
<item key="value" type="dictionary"><dictionary>
<item key="__obj_attrs__" type="list"><list>
</list>
</item>
<item key="access" type="dictionary"><dictionary>
<item key="edit" type="list"><list>
</list>
</item>
<item key="insert" type="list"><list>
</list>
</item>
</dictionary>
</item>
<item key="acquired" type="int">0</item>
<item key="name"><![CDATA[Discussions]]></item>
<item key="package"><![CDATA[com.zms.peerreview]]></item>
<item key="type"><![CDATA[ZMSPackage]]></item>
</dictionary>
</item>
</dictionary>
</item>
<item type="dictionary"><dictionary>
<item key="dtml"><![CDATA[<!-- BO bodyContentZMSCustom_BulletinBoard -->

<dtml-if "URL.find('/manage')>=0">
    <h2><dtml-var "getTitlealt(REQUEST)"></h2>
<dtml-else>
    <dtml-var "getObjProperty('initReq',REQUEST)">
    <dtml-var "getObjProperty('displayTabs',REQUEST)">
    <div style="padding: 4px; border-bottom: solid 1px silver; border-right: solid 1px silver; background-color: #C8DBE2;">
        <dtml-var "getObjProperty(REQUEST.get(actionId),REQUEST)">
        <dtml-var "getObjProperty(tabSheet,REQUEST)">
    </div>
</dtml-if>

<!-- EO bodyContentZMSCustom_BulletinBoard -->]]></item>
<item key="enabled" type="int">1</item>
<item key="key"><![CDATA[BulletinBoard]]></item>
<item key="value" type="dictionary"><dictionary>
<item key="__obj_attrs__" type="list"><list>
<item type="dictionary"><dictionary>
<item key="custom"><![CDATA[ZMSPackage Discussions-3.0.1
------------------------------
- requires ZMS-2.8.1 or higher
- runs with ZMS-2.3.2-b45 (without package-functionality)

Author: 
- Christian Meier <post@christianmeier.info>
- based on Bulletin-Board-2.0.2 (26.05.2004) by Dr. Frank Hoffmann <fh@hoffmannliebenberg.de>

Overview:
- [com.zms.discussions] Discussions (Package)
  |_[BulletinBoard] Bulletin-Board (Page-Element)
  |_[BulletinBoardMessages] Messages (Datatable)
  |_[BulletinBoardNotifications] Notifications (Datatable)
  |_[BulletinBoardRatings] Ratings (Datatable)

Features:
- Notfication for coming replies 
- Rating the usefulness of content 
- Tab "Overview" thread-navigation is clearer 
- Tab "New Topic" inserted 
- "Reply" opens a new screen 

History: 
- 2005-01-10 added Notification-handling to alert on new messages
- 2005-03-04 added Unsubscription-handling for alterting on new messages
- 2005-10-24 added Ranking-handling for rating the usefulness of content
- 2005-12-17 completed code-review and cleanup of user interface
- 2006-01-04 added multilang-support and packaged

Todo: 
- cleanup method-names (displayNew, insertNew, ...)
- create methods for calculateRating / parseLinks in displayMessage
- create methods for sendMail in sendNotification
- make it tableless / cleanup css
- encapsulate inline styles (f_css_defaults) => problem with SpecObj-Resource-Properties]]></item>
<item key="default"></item>
<item key="id"><![CDATA[_README]]></item>
<item key="keys" type="list"><list>
</list>
</item>
<item key="mandatory" type="int">0</item>
<item key="multilang" type="int">0</item>
<item key="name"><![CDATA[README]]></item>
<item key="repetitive" type="int">0</item>
<item key="type"><![CDATA[constant]]></item>
</dictionary>
</item>
<item type="dictionary"><dictionary>
<item key="custom" type="file">
<data content_type="image/gif" filename="ico_BulletinBoard.gif" type="file">47494638396112001000e60000c58f0dfcfef8040204fcc8546c6e6cfcfed5fcfdbbfcd765fcfc96848284fce56dfcee84fcfa7fc80000d1c6b572736fc6ac7fc7a04ff5dbdb766a69c352539b78547a5325c63333cf9e3c7f4521af9276cd6363958978c455549b0e00dfb668fcf8f8a40000a10606856b4e958d85885e33937758d79d7aac0000f9ca65a07d5abc7b3ad00000821900c60b0b9c4645faf8f6b10000be0000712802845e3aaf1210cc0000c03d3fe5c2c2f7d7796d390af9f6f4b57576a39190a70000deafaf7d4e25c7736a868183a30101ffffff00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000021f90401000044002c00000000120010000007a480440083848585448882018b8b058c8c000989000595969795000493069d029fa09d069a9c08028f8b020808a48800a6a99f8c020cad820ba7a8a9b59baeb8b10123191d142718bd820a0ab98b0e3a3e3222413d20ae07a0a024161e362843171b3f820207e5e639262d0d31212c2e388203f2f30329103335372f3c12aef4f41f80ac982024912043842294e020c920910404224a24f080860a180e331ad4506187c140003b</data></item>
<item key="default"></item>
<item key="id"><![CDATA[icon]]></item>
<item key="keys" type="list"><list>
</list>
</item>
<item key="mandatory" type="int">0</item>
<item key="multilang" type="int">0</item>
<item key="name"><![CDATA[Icon]]></item>
<item key="repetitive" type="int">0</item>
<item key="type"><![CDATA[resource]]></item>
</dictionary>
</item>
<item type="dictionary"><dictionary>
<item key="custom" type="file">
<data content_type="image/gif" filename="ico_BulletinBoard_disabled.gif" type="file">47494638396112001000e60000989898fdfdfd0303036d6d6dd0d0d0fbfbfbf9f9f9999999cfcfcffcfcfcdadadafefefef7f7f7040404828282f5f5f5ececec6464648a8a8ae4e4e4676767fafafa565656dbdbdb6c6c6c515151a7a7a78e8e8ee5e5e5d9d9d9afafaf8787876e6e6ef8f8f8797979484848666666585858535353bcbcbc5252528383835f5f5f4343434f4f4f959595cacacabababa7e7e7e4545455a5a5a777777d1d1d18b8b8bc6c6c6696969ababab7b7b7b5c5c5c8888887272726565658181815959596f6f6fffffff00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000021f90401000041002c00000000120010000007ab80410083848585418882018b8b058c8c000e89008e090595980500039306151502a1a29e069b9d0c028f0b0b020c0ca68800a88ba28c020fb08210a9aab4b89cb1bbb4a940162233381ac0821c13bc8b3623262a19352d06b117a2a21b3a2c241619181f2f820d0ae817e81d3931112528373d2e820804f7f8341e2b3f18113b1362d9cb77ef840c09207c241264e8c0200d1424485a18c4c1808b1807f0a0902204c58f0b01c060b03010003b</data></item>
<item key="default"></item>
<item key="id"><![CDATA[icon_disabled]]></item>
<item key="keys" type="list"><list>
</list>
</item>
<item key="mandatory" type="int">0</item>
<item key="multilang" type="int">0</item>
<item key="name"><![CDATA[Icon: Disabled]]></item>
<item key="repetitive" type="int">0</item>
<item key="type"><![CDATA[resource]]></item>
</dictionary>
</item>
<item type="dictionary"><dictionary>
<item key="custom"></item>
<item key="default"></item>
<item key="id"><![CDATA[titlealt]]></item>
<item key="keys" type="list"><list>
</list>
</item>
<item key="mandatory" type="int">1</item>
<item key="multilang" type="int">1</item>
<item key="name"><![CDATA[Kurztitel]]></item>
<item key="repetitive" type="int">0</item>
<item key="type"><![CDATA[string]]></item>
</dictionary>
</item>
<item type="dictionary"><dictionary>
<item key="custom"></item>
<item key="default"></item>
<item key="id"><![CDATA[title]]></item>
<item key="keys" type="list"><list>
</list>
</item>
<item key="mandatory" type="int">1</item>
<item key="multilang" type="int">1</item>
<item key="name"><![CDATA[Titel]]></item>
<item key="repetitive" type="int">0</item>
<item key="type"><![CDATA[string]]></item>
</dictionary>
</item>
<item type="dictionary"><dictionary>
<item key="custom"></item>
<item key="default"></item>
<item key="id"><![CDATA[bbAdmin]]></item>
<item key="keys" type="list"><list>
</list>
</item>
<item key="mandatory" type="int">1</item>
<item key="multilang" type="int">0</item>
<item key="name"><![CDATA[Administrator (eMail)]]></item>
<item key="repetitive" type="int">0</item>
<item key="type"><![CDATA[string]]></item>
</dictionary>
</item>
<item type="dictionary"><dictionary>
<item key="custom"></item>
<item key="default"></item>
<item key="id"><![CDATA[bbMessages]]></item>
<item key="keys" type="list"><list>
</list>
</item>
<item key="mandatory" type="int">1</item>
<item key="multilang" type="int">0</item>
<item key="name"><![CDATA[Messages]]></item>
<item key="repetitive" type="int">0</item>
<item key="type"><![CDATA[BulletinBoardMessages]]></item>
</dictionary>
</item>
<item type="dictionary"><dictionary>
<item key="custom"></item>
<item key="default"></item>
<item key="id"><![CDATA[bbNotifications]]></item>
<item key="keys" type="list"><list>
</list>
</item>
<item key="mandatory" type="int">1</item>
<item key="multilang" type="int">0</item>
<item key="name"><![CDATA[Notifications]]></item>
<item key="repetitive" type="int">0</item>
<item key="type"><![CDATA[BulletinBoardNotifications]]></item>
</dictionary>
</item>
<item type="dictionary"><dictionary>
<item key="custom"></item>
<item key="default"></item>
<item key="id"><![CDATA[bbRatings]]></item>
<item key="keys" type="list"><list>
</list>
</item>
<item key="mandatory" type="int">1</item>
<item key="multilang" type="int">0</item>
<item key="name"><![CDATA[Ratings]]></item>
<item key="repetitive" type="int">0</item>
<item key="type"><![CDATA[BulletinBoardRatings]]></item>
</dictionary>
</item>
<item type="dictionary"><dictionary>
<item key="custom" type="file">
<data content_type="image/gif" filename="mail_icon.gif" type="file">47494638396110001000f700004e4e4e64a1e5ee3720f0442ff2614fa3a3a382b3ea8dbdf0b1d0f2b6d3f3b9d5f3bdd7f4bed8f4c2daf5c5dcf5c9def6cadff6d0e3f7d1e3f7d6e6f8dae9f9dceaf9ddeaf9dfecfae1edfae4eefae8f1fbe9f2fbebf3fcedf4fcf0f6fcf2f7fdf5f9fdf9fbfefcfdfefefeffed1717ffffff00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000021f90401000024002c00000000100010000008730049081c48b0a0c1830813122cc0b0a1c386000416284191a208101d3254887020228989154784f0a0e10281011d2596086020804b0e18260c1090f263c58b19294470b0a0e644962e0d5890f08041029f25447ed870610284060a10f83c40b5aa55aa1e0b00d8cab52b578560c38a1d5b3020003b</data></item>
<item key="default"></item>
<item key="id"><![CDATA[mail_link]]></item>
<item key="keys" type="list"><list>
</list>
</item>
<item key="mandatory" type="int">0</item>
<item key="multilang" type="int">0</item>
<item key="name"><![CDATA[Mail-Link]]></item>
<item key="repetitive" type="int">0</item>
<item key="type"><![CDATA[resource]]></item>
</dictionary>
</item>
<item type="dictionary"><dictionary>
<item key="custom" type="file">
<data content_type="image/gif" filename="klammer.gif" type="file">4749463839610e00100091ff00c0c0c0bbbbbb00000000000021f90401000000002c000000000e001000000228846fa2c820015f730189266faa2773da5552b881243896e8679eaadbbef19b5a5ccd283803b14d01003b</data></item>
<item key="default"></item>
<item key="id"><![CDATA[mail_appendix]]></item>
<item key="keys" type="list"><list>
</list>
</item>
<item key="mandatory" type="int">0</item>
<item key="multilang" type="int">0</item>
<item key="name"><![CDATA[Mail-Appendix]]></item>
<item key="repetitive" type="int">0</item>
<item key="type"><![CDATA[resource]]></item>
</dictionary>
</item>
<item type="dictionary"><dictionary>
<item key="custom" type="file">
<data content_type="image/gif" filename="up.gif" type="file">47494638396111000f00b30c00d5d5d57c7c7cc0c0c0a2a2a27e7e7ebebebebfbfbf7d7d7dd6d6d6d7d7d72a2a2affffff00000000000000000000000021f9040100000c002c0000000011000f0000046390c9496b0de704622b59e032289d74108496ae5946324728cfcbfb210ba0e03c9218afd802a1282686894421f10a0c8b5080cf073481708a6402215016828b23132135280555d895082d16cc60add98078d3bfd604807e172c0b44126d838425860c11003b</data></item>
<item key="default"></item>
<item key="id"><![CDATA[thread_up]]></item>
<item key="keys" type="list"><list>
</list>
</item>
<item key="mandatory" type="int">0</item>
<item key="multilang" type="int">0</item>
<item key="name"><![CDATA[Thread-Up]]></item>
<item key="repetitive" type="int">0</item>
<item key="type"><![CDATA[resource]]></item>
</dictionary>
</item>
<item type="dictionary"><dictionary>
<item key="custom"><![CDATA[<!-- // BO initReq // -->

<dtml-call "REQUEST.set('actionId','ACTION%s'%meta_id)">

<!-- // EO initReq // -->]]></item>
<item key="default"></item>
<item key="id"><![CDATA[initReq]]></item>
<item key="keys" type="list"><list>
</list>
</item>
<item key="mandatory" type="int">0</item>
<item key="multilang" type="int">0</item>
<item key="name"><![CDATA[Init request]]></item>
<item key="repetitive" type="int">0</item>
<item key="type"><![CDATA[method]]></item>
</dictionary>
</item>
<item type="dictionary"><dictionary>
<item key="custom"><![CDATA[<!-- // BO displayTabs // -->

<dtml-let tabs="[
    'displayOverview',getLangStr('bbOverview',lang),
    'insertNew',getLangStr('bbNewTopic',lang),
    'displaySearch',getLangStr('bbSearch',lang),
    'displayNew',getLangStr('bbWhatsNew',lang),
    'displayHelp','?',
    ]">

    <dtml-comment>
    <!-- +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-
         +-+-  Select TabSheet
         +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+- -->
    </dtml-comment>
    
    <dtml-if "REQUEST.form.has_key('newTabSheet')">
        <dtml-call "SESSION.set('sessTabSheet',REQUEST.form.get('newTabSheet'))">
    <dtml-else>
        <dtml-call "SESSION.set('sessTabSheet',SESSION.get('sessTabSheet',tabs[0]))">
    </dtml-if>
    <dtml-call "REQUEST.set('tabSheet',SESSION.get('sessTabSheet'))">
    
    <dtml-comment>
    <!-- +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-
         +-+-  Select TabSheet Form
         +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+- -->
    </dtml-comment>
    
    <table cellspacing="0" cellpadding="0" border="0">
    <tr valign="top">
        <td align="left">
            <dtml-in "_.range(_.len(tabs)/2)">
                <dtml-let i=sequence-item action="tabs[i*2]" title="tabs[i*2+1]">
                    <div style="float:left; padding-left:4px; padding-top:2px; padding-right:4px; padding-bottom:2px; border-top:1px solid #C8DBE2; border-left:1px solid #C8DBE2; border-right:1px solid silver; margin-left:2px; margin-right:2px; background-color:<dtml-if "action==tabSheet">#C8DBE2<dtml-else>white</dtml-if>;">
                        <a href="<dtml-var "url_append_params(URL,{'newTabSheet':action,'boardId':'%s_%s'%(id,aq_parent.id)})">" style="text-decoration:none;"><dtml-var title></a>
                    </div>
                </dtml-let>
            </dtml-in>
        <td>
    </tr>
    </table>

</dtml-let>

<!-- // EO displayTabs // -->]]></item>
<item key="default"></item>
<item key="id"><![CDATA[displayTabs]]></item>
<item key="keys" type="list"><list>
</list>
</item>
<item key="mandatory" type="int">0</item>
<item key="multilang" type="int">0</item>
<item key="name"><![CDATA[Display tabulators]]></item>
<item key="repetitive" type="int">0</item>
<item key="type"><![CDATA[method]]></item>
</dictionary>
</item>
<item type="dictionary"><dictionary>
<item key="custom"><![CDATA[<!-- // BO displayOverview // -->

<dtml-if "REQUEST.get('boardId','')=='%s_%s'%(id,aq_parent.id) and REQUEST.form.has_key('bbmId')">
    <dtml-var "getObjProperty('displayMessage',REQUEST)">
<dtml-else>
    <table cellspacing="1" cellpadding="1" border="0" style="background-color: #C8DBE2;">
    <tr align="center" valign="top" style="background-color: #C8DBE2;">
        <td><strong><dtml-var "getLangStr('bbTopic',lang)"></strong></td>
        <td><strong><dtml-var "getLangStr('bbAuthor',lang)"></strong></td>
        <td><strong><dtml-var "getLangStr('bbMessages',lang)"></strong></td>
        <td><strong><dtml-var "getLangStr('bbCreated',lang)"></strong></td>
        <td><strong><dtml-var "getLangStr('bbLast',lang)"></strong></td>
    </tr>
    <dtml-try>
        <dtml-call "REQUEST.set('res',bbMessages.getObjProperty('records',REQUEST))">
    <dtml-except>
        <dtml-call "REQUEST.set('res',{})">
    </dtml-try>
    <dtml-in "filter_list(res,'bbmBbmId','','==')" mapping>
        <dtml-let children="sort_list(tree_list(res,'bbmId','bbmBbmId',bbmId,1),'bbmDateTime','desc')">
            <tr align="left" valign="top" class="<dtml-if sequence-even>neutralColorWhite<dtml-else>neutralColorWhite</dtml-if>">
                <td><a href="<dtml-var "url_append_params(URL,{'newTabSheet':'displayOverview','boardId':'%s_%s'%(id,aq_parent.id),'bbmId':bbmId})">"><dtml-var bbmSubject></a></td>
                <td><dtml-var bbmAuthor></td>
                <td align="center"><dtml-if children><dtml-var "_.len(children)"><dtml-else>0</dtml-if></td>
                <td align="center"><dtml-var "getLangFmtDate(bbmDateTime,lang,'DATE_FMT')"></td>
                <td align="center"><dtml-if children><dtml-var "getLangFmtDate(children[0]['bbmDateTime'],lang,'DATE_FMT')"><dtml-else>&nbsp;</dtml-if></td>
            </tr>
        </dtml-let>
    </dtml-in>
    </table>
</dtml-if>

<!-- // EO displayOverview // -->]]></item>
<item key="default"></item>
<item key="id"><![CDATA[displayOverview]]></item>
<item key="keys" type="list"><list>
</list>
</item>
<item key="mandatory" type="int">0</item>
<item key="multilang" type="int">0</item>
<item key="name"><![CDATA[Display overview]]></item>
<item key="repetitive" type="int">0</item>
<item key="type"><![CDATA[method]]></item>
</dictionary>
</item>
<item type="dictionary"><dictionary>
<item key="custom"><![CDATA[<!-- // BO displaySearch // -->

<dtml-try>
    <dtml-call "REQUEST.set('resMsg',bbMessages.getObjProperty('records',REQUEST))">
<dtml-except>
    <dtml-call "REQUEST.set('resMsg',{})">
</dtml-try>

<form method="get">
    <input type="hidden" name="boardId" value="<dtml-var "'%s_%s'%(id,aq_parent.id)">">
    <table border="0" cellspacing="5" cellpadding="0">
    <tr valign="middle">
        <td><dtml-var "getLangStr('bbSearchterm',lang)"></td>
        <td><input type="text" name="searchterm" value="<dtml-var "REQUEST.form.get('searchterm','')">" size="30"></td>
        <td><input type="submit" name="btn" value="<dtml-var "getLangStr('bbSearch',lang)">"></td>
    </tr>
    </table>
</form>

<dtml-if "REQUEST.form.has_key('searchterm')">
    <hr size="1" />
    <table cellspacing="1" cellpadding="1" border="0" style="background-color: #C8DBE2;">
    <tr align="center" valign="top" style="background-color: #C8DBE2;">
        <td><strong><dtml-var "getLangStr('bbSubject',lang)"></strong></td>
        <td><strong><dtml-var "getLangStr('bbAuthor',lang)"></strong></td>
        <td><strong><dtml-var "getLangStr('bbCreated',lang)"></strong></td>
    </tr>
    <dtml-call "REQUEST.set('res',filter_list(resMsg,_.None,REQUEST.form.get('searchterm'),'%'))">
    <dtml-in res size=15 start=qs mapping>
        <tr align="left" valign="top" class="<dtml-if sequence-even>neutralColorWhite<dtml-else>neutralColorWhite</dtml-if>">
            <td>
            
            <a href="<dtml-var "url_append_params(URL,{'newTabSheet':'displayOverview','boardId':'%s_%s'%(id,aq_parent.id),'bbmId':bbmId})">"><dtml-var bbmSubject></a>
            <dtml-if bbmFile>
            <img src="<dtml-var "getObjProperty('mail_appendix',REQUEST).getHref(REQUEST)">" alt="" border="0" align="absmiddle" />
            </dtml-if>
            
            </td>
            <td><dtml-var bbmAuthor></td>
            <td><dtml-var "getLangFmtDate(bbmDateTime,lang,'DATETIME_FMT')"></td>
        </tr>
    </dtml-in>
    <tr align="left" valign="top" style="background-color: #C8DBE2;">
        <td colspan="3">
            <table cellspacing="0" cellpadding="0" border="0">
            <tr>
                <td>
                    <strong>
                    <dtml-in res size=15 start=qs>
                        <dtml-if sequence-start><dtml-var "_['sequence-index']+1"></dtml-if>
                        <dtml-if sequence-end>- <dtml-var "_['sequence-index']+1"></dtml-if>
                    </dtml-in>
                    <dtml-var "getLangStr('bbOf',lang)"> <dtml-var "_.len(res)">
                    </strong>
                </td>
                <td colspan="2" align="right">&nbsp;                    
                    <dtml-in res previous size=10 start=qs>
                        <a href="<dtml-var "url_append_params(URL,{'boardId':'%s_%s'%(id,aq_parent.id)})">&qs=<dtml-var previous-sequence-start-number>&searchterm=<dtml-var searchterm url_quote>&boardId=<dtml-var "'%s_%s'%(id,aq_parent.id)">">&laquo; <dtml-var "getZMILangStr('ATTR_PREVIOUS')"> <dtml-var previous-sequence-size></a>
                    </dtml-in>
                    <dtml-in res next size=10 start=qs>
                        <a href="<dtml-var "url_append_params(URL,{'boardId':'%s_%s'%(id,aq_parent.id)})">&qs=<dtml-var next-sequence-start-number>&searchterm=<dtml-var searchterm url_quote>&boardId=<dtml-var "'%s_%s'%(id,aq_parent.id)">"><dtml-var "getZMILangStr('ATTR_NEXT')"> <dtml-var next-sequence-size> &raquo;</a>
                    </dtml-in>
                    
                </td>
            </tr>
            </table>
        </td>
    </tr>
    </table>
<dtml-else>
    <br/><br/><br/><br/><br/><br/>
</dtml-if>

<!-- // EO displaySearch // -->]]></item>
<item key="default"></item>
<item key="id"><![CDATA[displaySearch]]></item>
<item key="keys" type="list"><list>
</list>
</item>
<item key="mandatory" type="int">0</item>
<item key="multilang" type="int">0</item>
<item key="name"><![CDATA[Display search]]></item>
<item key="repetitive" type="int">0</item>
<item key="type"><![CDATA[method]]></item>
</dictionary>
</item>
<item type="dictionary"><dictionary>
<item key="custom"><![CDATA[<!-- // BO displayNew // -->

<dtml-try>
    <dtml-call "REQUEST.set('resMsg',bbMessages.getObjProperty('records',REQUEST))">
<dtml-except>
    <dtml-call "REQUEST.set('resMsg',{})">
</dtml-try>

<table width="90%" cellspacing="1" cellpadding="1" border="0" style="background-color: #C8DBE2;">
<tr align="center" valign="top" style="background-color: #C8DBE2;">
    <td><strong><dtml-var "getLangStr('bbSubject',lang)"></strong></td>
    <td><strong><dtml-var "getLangStr('bbAuthor',lang)"></strong></td>
    <td><strong><dtml-var "getLangStr('bbCreated',lang)"></strong></td>
</tr>
<dtml-call "REQUEST.set('res',sort_list(resMsg,'bbmDateTime','desc'))">
<dtml-in res size=20 start=qs mapping>
    <tr align="left" valign="top" class="<dtml-if sequence-even>neutralColorWhite<dtml-else>neutralColorWhite</dtml-if>">
        <td>
            <a href="<dtml-var "url_append_params(URL,{'newTabSheet':'displayOverview','boardId':'%s_%s'%(id,aq_parent.id),'bbmId':bbmId})">"><dtml-var bbmSubject></a>
            <dtml-if bbmFile>
            <img src="<dtml-var "getObjProperty('mail_appendix',REQUEST).getHref(REQUEST)">" alt="" border="0" align="absmiddle" />
            </dtml-if>
        </td>
        <td><dtml-var bbmAuthor></td>
        <td><dtml-var "getLangFmtDate(bbmDateTime,lang,'DATETIME_FMT')"></td>
    </tr>
</dtml-in>
<tr align="left" valign="top" style="background-color: #C8DBE2;">
    <td colspan="3">
        <table cellspacing="0" cellpadding="0" border="0">
        <tr>
            <td>
                <strong>
                <dtml-in res size=20 start=qs>
                    <dtml-if sequence-start><dtml-var "_['sequence-index']+1"></dtml-if>
                    <dtml-if sequence-end>- <dtml-var "_['sequence-index']+1"></dtml-if>
                </dtml-in>
                <dtml-var "getLangStr('bbOf',lang)"> <dtml-var "_.len(res)">
                </strong>
            </td>
            <td colspan="2" align="right">&nbsp;
                <dtml-in res previous size=10 start=qs>
                    <a href="<dtml-var "url_append_params(URL,{'boardId':'%s_%s'%(id,aq_parent.id)})">&qs=<dtml-var previous-sequence-start-number> ">&laquo; <dtml-var "getZMILangStr('ATTR_PREVIOUS')"> <dtml-var previous-sequence-size></a>
                </dtml-in>
                <dtml-in res next size=10 start=qs>
                    <a href="<dtml-var "url_append_params(URL,{'boardId':'%s_%s'%(id,aq_parent.id)})">&qs=<dtml-var next-sequence-start-number> "><dtml-var "getZMILangStr('ATTR_NEXT')"> <dtml-var next-sequence-size> &raquo;</a>
                </dtml-in>
            </td>
        </tr>
        </table>
    </td>
</tr>
</table>

<!-- // EO displayNew // -->]]></item>
<item key="default"></item>
<item key="id"><![CDATA[displayNew]]></item>
<item key="keys" type="list"><list>
</list>
</item>
<item key="mandatory" type="int">0</item>
<item key="multilang" type="int">0</item>
<item key="name"><![CDATA[Display new]]></item>
<item key="repetitive" type="int">0</item>
<item key="type"><![CDATA[method]]></item>
</dictionary>
</item>
<item type="dictionary"><dictionary>
<item key="custom"><![CDATA[<!-- // BO displayHelp // -->

<dtml-if "lang=='ger'">
    <h2>Anleitung: Beitrag schreiben</h2>
    <ul style="bullet">
        <li>Geben Sie Name, eMail-Adresse und den Titel des Beitrags ein.</li>
        <li>Schreiben Sie den Beitragstext in das große Feld.</li>
        <!-- <li>Klicken Sie den "Vorschau..."-Button für eine Test-Ansicht.</li> -->
        <li>Klicken Sie den "Absenden"-Button um den Beitrag zu übermitteln.</li>
    </ul>
    <h2>Anleitung: Beitrag lesen</h2>
    <ul style="bullet">
        <li><strong>Neu</strong> ist eine nach Datum sortierte Liste der aktuellsten Beiträge.</li>
        <li>Klicken Sie auf den Titel eines Beitrags.</li>
        <!-- <li><strong>NT</strong> bedeutet leerer Beitrag ("No Text").</li> -->
        <li>Benutzen Sie <img src="<dtml-var "getObjProperty('mail_link',REQUEST).getHref(REQUEST)">" alt="" border="0" align="absmiddle"> um dem Autor eine persönliche eMail zu senden.</li>
    </ul>
<dtml-else>
    <h2>Instruction: How to write a message</h2>
    <ul style="bullet">
        <li>Please enter your name, e-mail adress and the title of your message.</li>
        <li>Enter the message text in the big area.</li>
        <!-- <li>Click the "Preview..."-Button for a test.</li> -->
        <li>Click "Send" to transfer the message.</li>
    </ul>
    <h2>Instruction: How to read a message</h2>
    <ul style="bullet">
        <li><strong>What's new</strong> means a list of recent messages sorted according to dates.</li>
        <li>Please click on a message´s title.</li>
        <!-- <li><strong>NT</strong> means empty message ("No Text").</li> -->
        <li>Use <img src="<dtml-var "getObjProperty('mail_link',REQUEST).getHref(REQUEST)">" alt="" border="0" align="absmiddle"> to send a personal mail to the author.</li>
    </ul>
</dtml-if>

<!-- // EO displayHelp // -->]]></item>
<item key="default"></item>
<item key="id"><![CDATA[displayHelp]]></item>
<item key="keys" type="list"><list>
</list>
</item>
<item key="mandatory" type="int">0</item>
<item key="multilang" type="int">0</item>
<item key="name"><![CDATA[Display help]]></item>
<item key="repetitive" type="int">0</item>
<item key="type"><![CDATA[method]]></item>
</dictionary>
</item>
<item type="dictionary"><dictionary>
<item key="custom"><![CDATA[<!-- // BO displayMessage // -->

<dtml-try>
    <dtml-call "REQUEST.set('resMsg',bbMessages.getObjProperty('records',REQUEST))">
    <dtml-call "REQUEST.set('resNtf',bbNotifications.getObjProperty('records',REQUEST))">
    <dtml-call "REQUEST.set('resRtg',bbRatings.getObjProperty('records',REQUEST))">
<dtml-except>
    <dtml-call "REQUEST.set('resMsg',{})">
    <dtml-call "REQUEST.set('resNtf',{})">
    <dtml-call "REQUEST.set('resRtg',{})">
</dtml-try>

<dtml-comment>
<!-- +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-
     +-+-  Insert Message if button "Send" is pressed
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+- -->
</dtml-comment>
<dtml-if "REQUEST.get('boardId','') == '%s_%s'%(id,aq_parent.id) and REQUEST.get('btn','')==getLangStr('bbBtnSend',lang)">

    <dtml-with bbMessages>
        <dtml-call "REQUEST.set('newRow',{
            'bbmId': getNewId(),
            'bbmSubject': REQUEST.get('newBbmSubject').strip(),
            'bbmAuthor': REQUEST.get('newBbmAuthor').strip(),
            'bbmEmail': REQUEST.get('newBbmEmail').strip(),
            'bbmDateTime':parseLangFmtDate(getLangFmtDate(ZopeTime(),lang),lang),
            'bbmBody': REQUEST.get('newBbmBody').strip(),
            'bbmFile': formatObjAttrValue(getObjAttr('bbmFile'),REQUEST.form.get('newBbmFile',_.None),lang),	
            'bbmBbmId': REQUEST.get('newBbmBbmId'),
            })">
        <dtml-call "resMsg.append(newRow)">
        <dtml-call "setObjStateModified(REQUEST)">
        <dtml-call "setObjProperty('records',resMsg,lang)">
        <dtml-call "onChangeObj(REQUEST,forced=1)">
    </dtml-with>
    
    <dtml-call "REQUEST.set('bbmId',newRow['bbmId'])">
    
    <dtml-let expires="(_.DateTime() + 365).toZone('GMT').rfc822()">
        <dtml-call "RESPONSE.setCookie('__ac_author',newRow['bbmAuthor'],path='/',expires=expires)">
        <dtml-call "RESPONSE.setCookie('__ac_email',newRow['bbmEmail'],path='/',expires=expires)">
    </dtml-let>
    
    <div style="color:maroon; background-color: white; border: solid 1px black; padding: 4px;">
        <dtml-try>
        <dtml-var "getLangStr('bbMsgMessageInsertOk',lang)%getLangFmtDate(ZopeTime(),lang)">
        <dtml-except>
        </dtml-try>
    </div>
  
    <dtml-comment>
    <!-- ##### Insert notification if checkbox is checked ##### -->
    </dtml-comment>  
    <dtml-if "REQUEST.has_key('newBbnEmailNtf') and _.int(REQUEST.get('newBbnEmailNtf'))==1">
        <div style="color:maroon; background-color: white; border: solid 1px black; padding: 4px;">
            <dtml-var "getObjProperty('insertNotification',REQUEST)">
        </div>
    </dtml-if>
    
    <dtml-comment>
    <!-- ##### Send notification ##### -->
    </dtml-comment>
    <div style="color:maroon; background-color: white; border: solid 1px black; padding: 4px;">
        <dtml-var "getObjProperty('sendNotification',REQUEST)">
    </div>

<dtml-comment>    
<!-- +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-
     +-+-  Insert Notification if button "Notify" is pressed
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+- -->
</dtml-comment>
<dtml-elif "REQUEST.get('boardId','') == '%s_%s'%(id,aq_parent.id) and REQUEST.get('btn','')==getLangStr('bbBtnNotify',lang)">

    <div style="color:maroon; background-color: white; border: solid 1px black; padding: 4px;">
        <dtml-var "getObjProperty('insertNotification',REQUEST)">
    </div>

<dtml-comment>
<!-- +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-
     +-+-  Insert Rating if button "Rate" is pressed
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+- -->
</dtml-comment>
<dtml-elif "REQUEST.get('boardId','') == '%s_%s'%(id,aq_parent.id) and REQUEST.get('btn','')==getLangStr('bbBtnRate',lang)">

    <div style="color:maroon; background-color: white; border: solid 1px black; padding: 4px;">
        <dtml-var "getObjProperty('insertRating',REQUEST)">
    </div>

</dtml-if>


<dtml-in "sort_list(filter_list(resMsg,'bbmId',REQUEST.get('bbmId',''),'=='),'bbmDateTime','asc')" mapping>

<table width="95%" cellspacing="2" cellpadding="1" border="0">
<dtml-comment>
<!-- +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-
     +-+-  Display Message-Header with rating
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+- -->
</dtml-comment>    
<tr>
    <td class="neutralColorWhite">
        <dtml-let thread_up="getObjProperty('thread_up',REQUEST)">
            <dtml-in "tree_parents(resMsg,'bbmId','bbmBbmId',bbmBbmId,1)" mapping>
                <dtml-if sequence-end>
                    <a href="<dtml-var "url_append_params(URL,{'newTabSheet':'displayOverview','boardId':'%s_%s'%(id,aq_parent.id),'bbmId':bbmId})">"><img src="<dtml-var "thread_up.getHref(REQUEST)">" alt="" border="0" align="absmiddle" hspace="4" /></a><a href="<dtml-var "url_append_params(URL,{'newTabSheet':'displayOverview','boardId':'%s_%s'%(id,aq_parent.id),'bbmId':bbmId})">"><strong><small><dtml-var bbmSubject></small></strong></a>
                    <br /><img src="<dtml-var MISC_ZMS>tv_line_root.gif" alt="" border="0" hspace="6">
                </dtml-if> 
            </dtml-in>
        </dtml-let>
        
        <dtml-comment>
        <!-- ##### Calculate rating ##### -->
        </dtml-comment>
        <dtml-call "REQUEST.set('calcSum',0)">
        <dtml-call "REQUEST.set('calcLen',0)">
        <dtml-in "sort_list(filter_list(resRtg,'bbrMsg',REQUEST.get('bbmId'),'=='),'bbrDateTime','asc')" mapping>
            <dtml-call "REQUEST.set('calcSum',calcSum+_.int(bbrRate))">
            <dtml-call "REQUEST.set('calcLen',_['sequence-length'])">
        </dtml-in>
    
        <div style="margin-left:6px;">
            <strong><dtml-var bbmSubject></strong>
            <dtml-if "calcLen>0">
                <dtml-let 
                    stars05="bbRatings.getObjProperty('stars-0-5',REQUEST)"
                    stars10="bbRatings.getObjProperty('stars-1-0',REQUEST)"
                    stars15="bbRatings.getObjProperty('stars-1-5',REQUEST)"
                    stars20="bbRatings.getObjProperty('stars-2-0',REQUEST)"
                    stars25="bbRatings.getObjProperty('stars-2-5',REQUEST)"
                    stars30="bbRatings.getObjProperty('stars-3-0',REQUEST)"
                    stars35="bbRatings.getObjProperty('stars-3-5',REQUEST)"
                    stars40="bbRatings.getObjProperty('stars-4-0',REQUEST)"
                    stars45="bbRatings.getObjProperty('stars-4-5',REQUEST)"
                    stars50="bbRatings.getObjProperty('stars-5-0',REQUEST)"
                    calcRate="_.float(calcSum)/_.float(calcLen)">
                
                    <dtml-if "calcRate > 0 and calcRate < 1">
                        <img src="<dtml-var "stars05.getHref(REQUEST)">" alt="<dtml-var "'%1.1f'%(calcRate)">" border="0" align="middle" />
                    <dtml-elif  "calcRate >= 1 and calcRate < 1.5"> 
                        <img src="<dtml-var "stars10.getHref(REQUEST)">" alt="<dtml-var "'%1.1f'%(calcRate)">" border="0" align="middle" />
                    <dtml-elif  "calcRate >= 1.5 and calcRate < 2"> 
                        <img src="<dtml-var "stars15.getHref(REQUEST)">" alt="<dtml-var "'%1.1f'%(calcRate)">" border="0" align="middle" />   
                    <dtml-elif  "calcRate >= 2 and calcRate < 2.5"> 
                        <img src="<dtml-var "stars20.getHref(REQUEST)">" alt="<dtml-var "'%1.1f'%(calcRate)">" border="0" align="middle" />   
                    <dtml-elif  "calcRate >= 2.5 and calcRate < 3"> 
                        <img src="<dtml-var "stars25.getHref(REQUEST)">" alt="<dtml-var "'%1.1f'%(calcRate)">" border="0" align="middle" />
                    <dtml-elif  "calcRate >= 3 and calcRate < 3.5"> 
                        <img src="<dtml-var "stars30.getHref(REQUEST)">" alt="<dtml-var "'%1.1f'%(calcRate)">" border="0" align="middle" />
                    <dtml-elif  "calcRate >= 3.5 and calcRate < 4"> 
                        <img src="<dtml-var "stars35.getHref(REQUEST)">" alt="<dtml-var "'%1.1f'%(calcRate)">" border="0" align="middle" />
                    <dtml-elif  "calcRate >= 4 and calcRate < 4.5"> 
                        <img src="<dtml-var "stars40.getHref(REQUEST)">" alt="<dtml-var "'%1.1f'%(calcRate)">" border="0" align="middle" />
                    <dtml-elif  "calcRate >= 4.5 and calcRate < 5"> 
                        <img src="<dtml-var "stars45.getHref(REQUEST)">" alt="<dtml-var "'%1.1f'%(calcRate)">" border="0" align="middle" />
                    <dtml-elif  "calcRate >= 5"> 
                        <img src="<dtml-var "stars50.getHref(REQUEST)">" alt="<dtml-var "'%1.1f'%(calcRate)">" border="0" align="middle" />
                    </dtml-if>
                    (<dtml-var calcLen> <dtml-var "getLangStr('bbVotes',lang)">)
                </dtml-let>
            </dtml-if>
            <br />
            <dtml-var bbmAuthor> <dtml-if bbmEmail><a href="mailto:<dtml-var bbmEmail>"><img src="<dtml-var "getObjProperty('mail_link',REQUEST).getHref(REQUEST)">" alt="" border="0" align="absmiddle" /></a></dtml-if> <dtml-var "getLangFmtDate(bbmDateTime,lang,'DATETIME_FMT')">
        </div>
    
        <table cellspacing="0" cellpadding="0" border="0">
        <dtml-in "tree_list(resMsg,'bbmId','bbmBbmId',bbmId,0)" mapping>
            <dtml-let subchildren="tree_list(resMsg,'bbmId','bbmBbmId',bbmId,0)">
                <tr valign="bottom">
                    <dtml-if sequence-end>
                        <dtml-if subchildren>
                            <td><a href="<dtml-var "url_append_params(URL,{'newTabSheet':'displayOverview','boardId':'%s_%s'%(id,aq_parent.id),'bbmId':bbmId})">"><img src="<dtml-var MISC_ZMS>tv_last_pl.gif" alt="" border="0" align="absmiddle"></a></td>
                        <dtml-else>
                            <td><img src="<dtml-var MISC_ZMS>tv_last.gif" alt="" border="0" align="absmiddle"></td>
                        </dtml-if>
                    <dtml-else>
                        <dtml-if subchildren>
                            <td style="background-image:url(<dtml-var MISC_ZMS>tv_line.gif);"><a href="<dtml-var "url_append_params(URL,{'newTabSheet':'displayOverview','boardId':'%s_%s'%(id,aq_parent.id),'bbmId':bbmId})">"><img src="<dtml-var MISC_ZMS>tv_item_pl.gif" alt="" border="0" align="absmiddle"></a></td>
                        <dtml-else>
                            <td style="background-image:url(<dtml-var MISC_ZMS>tv_line.gif);"><img src="<dtml-var MISC_ZMS>tv_item.gif" alt="" border="0" align="absmiddle"></td>
                        </dtml-if>
                    </dtml-if>
                    <td valign="top">&nbsp;<small><a href="<dtml-var "url_append_params(URL,{'newTabSheet':'displayOverview','boardId':'%s_%s'%(id,aq_parent.id),'bbmId':bbmId})">"><strong><dtml-var bbmSubject></strong></a> - <dtml-var bbmAuthor> <dtml-var "getLangFmtDate(bbmDateTime,lang,'DATETIME_FMT')"> <dtml-if bbmFile><img src="<dtml-var "getObjProperty('mail_appendix',REQUEST).getHref(REQUEST)">" alt="" border="0" align="absmiddle" /></small></dtml-if></td>
                </tr>
            </dtml-let>
        </dtml-in>
        </table>
    </td>
</tr>
<dtml-comment>
<!-- +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-
     +-+-  Display Message-Body
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+- -->
</dtml-comment>
<tr>
    <form method="get" enctype="multipart/form-data">
    <input type="hidden" name="boardId" value="<dtml-var "'%s_%s'%(id,aq_parent.id)">">
    <input type="hidden" name="bbmId" value="<dtml-var bbmId>">
    <input type="hidden" name="newTabSheet" value="displayReply">
    <td>
        <table width="100%" border="0" cellspacing="0" cellpadding="0">
        <tr>
            <td>
                <table width="100%" border="0" cellspacing="1" cellpadding="1" class="neutralColorWhite">
                <tr style="background-color: #C8DBE2;">
                    <td><strong>Reply to this message</strong></td>
                    <td align="right" style="width:83px;"><input type="submit" style="width:80px;font-size:11px;" name="btn" value="<dtml-var "getLangStr('bbBtnReply',lang)">"></td>                
                </tr>
                </table>            
            </td>
        </tr>
        <tr>
            <td>
                <table width="100%" border="0" cellspacing="0" cellpadding="3">
                <tr>
                    <td class="neutralColorWhite">
                        <dtml-comment>
                        <!-- ##### parse links in message-bodytext ##### -->
                        </dtml-comment>
                        <dtml-call "REQUEST.set('bbmBodyStr',_.str.replace(bbmBody,'\n',' #br# '))">
                        <dtml-call "REQUEST.set('bbmBodyStr',_.str.split(bbmBodyStr,' '))">
                        <dtml-call "REQUEST.set('bbmBodyNewStr','')">
                        <dtml-in bbmBodyStr>
                            <dtml-let str="_.str.replace(_['sequence-item'],'#br#','\n')">
                                <dtml-if "_.str.find(str,'http://')>=0">
                                    <dtml-call "REQUEST.set('bbmBodyNewStr',bbmBodyNewStr+' '+'<a href=\'%s\' target=\'_blank\'>%s</a>'%(str,str))">
                                <dtml-else>
                                    <dtml-call "REQUEST.set('bbmBodyNewStr',bbmBodyNewStr+' '+str)">
                                </dtml-if>
                            </dtml-let>
                        </dtml-in>
                        
                        <dtml-var bbmBodyNewStr newline_to_br>
                        
                        <dtml-if bbmFile>
                            <div class="neutralColorWhite" style="margin:2px;padding:2px;">
                                <img src="<dtml-var "getObjProperty('mail_appendix',REQUEST).getHref(REQUEST)">" alt="" border="0" align="absmiddle" />
                                <strong>File:</strong>
                                <dtml-with bbMessages>
                                    <dtml-let file="formatObjAttrValue(getObjAttr('bbmFile'),bbmFile,lang)">
                                        <a href="<dtml-var "file.getHref(REQUEST)">" target="_blank"><img src="<dtml-var "file.getMimeTypeIconSrc()">" alt="<dtml-var "file.getContentType()">" border="0" align="absmiddle" hspace="2" /><dtml-var "file.getFilename()"></a> (<dtml-var "file.getDataSizeStr()">)
                                    </dtml-let>
                                </dtml-with>
                            </div>
                        </dtml-if>
                    </td>
                </tr>
                </table>
            </td>
        </tr>
        </table>
    </td>
    </form> 
</tr>
<dtml-comment>
<!-- +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-
     +-+-  Display Message-Rating
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+- -->
</dtml-comment>
<tr>
    <form method="post" enctype="multipart/form-data">
    <td>
        <input type="hidden" name="boardId" value="<dtml-var "'%s_%s'%(id,aq_parent.id)">">
        <input type="hidden" name="bbmId" value="<dtml-var bbmId>">
        <table width="100%" border="0" cellspacing="1" cellpadding="1" class="neutralColorWhite">
        <tr style="background-color: #C8DBE2;">
            <td><strong><dtml-var "getLangStr('bbRateUsefulness',lang)"></strong></td>
            <td align="right" style="width:83px;"><input type="submit" style="width:80px;font-size:11px;" name="btn" value="<dtml-var "getLangStr('bbBtnRate',lang)">"></td>
        </tr>
        <tr>
            <td colspan="2">
                <table border="0" cellspacing="1" cellpadding="1">
                <tr align="center">
                    <td></td>
                    <td>1</td>
                    <td>2</td>
                    <td>3</td>
                    <td>4</td>
                    <td>5</td>
                    <td></td>
                </tr>
                <tr align="center">
                    <td><strong><dtml-var "getLangStr('bbBeginning',lang)"></strong></td>
                    <td><input type="radio" name="newBbrRate" value="1" /></td>
                    <td><input type="radio" name="newBbrRate" value="2" /></td>
                    <td><input type="radio" name="newBbrRate" value="3" /></td>
                    <td><input type="radio" name="newBbrRate" value="4" /></td>
                    <td><input type="radio" name="newBbrRate" value="5" /></td>
                    <td><strong><dtml-var "getLangStr('bbExemplary',lang)"></strong></td>
                </tr>
                </table>
            </td>
        </tr>
        <dtml-comment>
        <tr>
            <td>
                <strong>Tell us why you rated the content this way. (optional)</strong>
                <br /><textarea cols="39" rows="5" name="newBbrExpl"></textarea>
            </td>
        </tr>
        </dtml-comment>
        </table>
    </td>
    </form>
</tr>
<dtml-comment>
<!-- +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-
     +-+-  Display Message-Notfication
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+- -->
</dtml-comment>
<tr>
    <form method="post" enctype="multipart/form-data">
    <td>
        <input type="hidden" name="boardId" value="<dtml-var "'%s_%s'%(id,aq_parent.id)">">
        <input type="hidden" name="bbmId" value="<dtml-var bbmId>">
        <table width="100%" border="0" cellspacing="1" cellpadding="1" class="neutralColorWhite">
        <tr style="background-color: #C8DBE2;">
            <td><strong><dtml-var "getLangStr('bbSendNotification',lang)"></strong></td>
            <td align="right" style="width:83px;"><input type="submit" style="width:80px;font-size:11px;" name="btn" value="<dtml-var "getLangStr('bbBtnNotify',lang)">"></td>
        </tr>
        <tr>
            <td colspan="2"><strong><dtml-var "getLangStr('bbMyEmail',lang)"></strong>&nbsp;<input type="text" name="newBbmEmail" value=""></td>
        </tr>
        </table>
    </td>
    </form>
</tr>
</table>
</dtml-in>

<!-- // EO displayMessage // -->]]></item>
<item key="default"></item>
<item key="id"><![CDATA[displayMessage]]></item>
<item key="keys" type="list"><list>
</list>
</item>
<item key="mandatory" type="int">0</item>
<item key="multilang" type="int">0</item>
<item key="name"><![CDATA[Display message]]></item>
<item key="repetitive" type="int">0</item>
<item key="type"><![CDATA[method]]></item>
</dictionary>
</item>
<item type="dictionary"><dictionary>
<item key="custom"><![CDATA[<!-- // BO displayReply // -->

<dtml-try>
    <dtml-call "REQUEST.set('resMsg',bbMessages.getObjProperty('records',REQUEST))">
    <dtml-call "REQUEST.set('resNtf',bbNotifications.getObjProperty('records',REQUEST))">
    <dtml-call "REQUEST.set('resRtg',bbRatings.getObjProperty('records',REQUEST))">
<dtml-except>
    <dtml-call "REQUEST.set('resMsg',{})">
    <dtml-call "REQUEST.set('resNtf',{})">
    <dtml-call "REQUEST.set('resRtg',{})">
</dtml-try>

<dtml-in "sort_list(filter_list(resMsg,'bbmId',REQUEST.get('bbmId',''),'=='),'bbmDateTime','asc')" mapping>

<!-- +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-
     +-+-  Insert Message Form
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+- -->
    <table width="95%" border="0" cellspacing="0" cellpadding="0">
    <form method="post" enctype="multipart/form-data">
    <input type="hidden" name="boardId" value="<dtml-var "'%s_%s'%(id,aq_parent.id)">">
    <input type="hidden" name="bbmId" value="<dtml-var bbmId>">
    <input type="hidden" name="newBbmBbmId" value="<dtml-var bbmId>">
    <input type="hidden" name="newTabSheet" value="displayOverview">
    <tr style="background-color: #C8DBE2;">
        <td>
            <table width="100%" border="0" cellspacing="1" cellpadding="1" class="neutralColorWhite">
            <tr style="background-color: #C8DBE2;">
                <td><strong><dtml-var "getLangStr('bbReplyMessage',lang)"> <a href="<dtml-var "url_append_params(URL,{'newTabSheet':'displayOverview','boardId':'%s_%s'%(id,aq_parent.id),'bbmId':bbmId})">"><dtml-var bbmSubject></a></strong></td>
                <td align="right" style="width:83px;"><input type="submit" style="width:80px;font-size:11px;" name="btn" value="<dtml-var "getLangStr('bbBtnSend',lang)">"></td>
            </tr>
            </table>
        </td>
    </tr>
    <tr valign="middle">
        <td>
            <table width="100%" class="neutralColorWhite" border="0" cellspacing="0" cellpadding="3">
            <tr>
                <td><strong><dtml-var "getLangStr('bbSubject',lang)"></strong></td>
                <td><input type="text" name="newBbmSubject" value="AW: <dtml-var bbmSubject>" size="40"></td>
            </tr>
            <tr valign="middle">
                <td><strong><dtml-var "getLangStr('bbAuthor',lang)"></strong></td>
                <td><input type="text" name="newBbmAuthor" value="<dtml-var "REQUEST.get('newBbmAuthor',REQUEST.cookies.get('__ac_author',''))">" size="40"></td>
            </tr>
            <tr valign="middle">
                <td><strong>eMail</strong></td>
                <td><input type="text" name="newBbmEmail" value="<dtml-var "REQUEST.get('newBbmEmail',REQUEST.cookies.get('__ac_email',''))">" size="40">
            </td>
            <tr valign="middle">
                <td></td>
                <td><input type="checkbox" name="newBbnEmailNtf" value="1">&nbsp;<dtml-var "getLangStr('bbSendNotification',lang)"></td>
            </tr>
            <tr valign="middle">
                <td colspan="2"><textarea name="newBbmBody" wrap="on" cols="39" rows="15" style="width:100%"></textarea></td>
            </tr>
            <tr valign="middle">
                <td><img src="<dtml-var "getObjProperty('mail_appendix',REQUEST).getHref(REQUEST)">" alt="" border="0" align="absmiddle" /><strong> <dtml-var "getLangStr('bbFile',lang)"></strong></td>
                <td><input type="file" name="newBbmFile" size="19" style="font-size:11px;"></td>
            </tr>
            </table>
        </td>
    </tr>
    </form>
    </table>

</dtml-in>

<!-- // EO displayReply // -->]]></item>
<item key="default"></item>
<item key="id"><![CDATA[displayReply]]></item>
<item key="keys" type="list"><list>
</list>
</item>
<item key="mandatory" type="int">0</item>
<item key="multilang" type="int">0</item>
<item key="name"><![CDATA[displayReply]]></item>
<item key="repetitive" type="int">0</item>
<item key="type"><![CDATA[method]]></item>
</dictionary>
</item>
<item type="dictionary"><dictionary>
<item key="custom"><![CDATA[<!-- // BO getChildMessages // -->

<dtml-try>
    <dtml-call "REQUEST.set('resMsg',bbMessages.getObjProperty('records',REQUEST))">
<dtml-except>
    <dtml-call "REQUEST.set('resMsg',{})">
</dtml-try>

<dtml-call "REQUEST.set('res%s'%bbmId,filter_list(resMsg,'bbmBbmId',bbmId,'=='))">

<dtml-in "copy_list(REQUEST.get('res%s'%bbmId))" mapping>
    <dtml-call "REQUEST.get('res%s'%bbmId).extend(getObjProperty('getChildMessages',REQUEST))">
</dtml-in>

<dtml-return "REQUEST.get('res%s'%bbmId)">

<!-- // EO getChildMessages // -->]]></item>
<item key="default"></item>
<item key="id"><![CDATA[getChildMessages]]></item>
<item key="keys" type="list"><list>
</list>
</item>
<item key="mandatory" type="int">0</item>
<item key="multilang" type="int">0</item>
<item key="name"><![CDATA[Returns child messages]]></item>
<item key="repetitive" type="int">0</item>
<item key="type"><![CDATA[method]]></item>
</dictionary>
</item>
<item type="dictionary"><dictionary>
<item key="custom"><![CDATA[<!-- // BO sendNotification // -->

<dtml-try>
    <dtml-call "REQUEST.set('resMsg',bbMessages.getObjProperty('records',REQUEST))">
    <dtml-call "REQUEST.set('resNtf',bbNotifications.getObjProperty('records',REQUEST))">
<dtml-except>
    <dtml-call "REQUEST.set('resMsg',{})">
    <dtml-call "REQUEST.set('resNtf',{})">
</dtml-try>

<dtml-call "REQUEST.set('isSent',[])">
<dtml-call "REQUEST.set('bcc','')">

<!-- ##### Get recipients ##### -->
<dtml-in "sort_list(filter_list(resMsg,'bbmId',REQUEST.get('bbmId'),'=='),'bbmDateTime','asc')" mapping>
    <dtml-in "tree_parents(resMsg,'bbmId','bbmBbmId',bbmBbmId,1)" mapping>
        <dtml-in "filter_list(resNtf,'bbnMsg',bbmId,'==')" mapping>
            <dtml-unless "bbnEmail in isSent">
                <dtml-unless "_.len(isSent)==0">
                    <dtml-call "REQUEST.set('bcc',bcc+',')">
                </dtml-unless>
                <dtml-call "REQUEST.set('bcc',bcc+bbnEmail)">
                <dtml-call "isSent.append(bbnEmail)">
            </dtml-unless>
        </dtml-in>
    </dtml-in>
</dtml-in>

<!-- ##### Send mail ##### -->
<dtml-try>

<dtml-sendmail MailHost="MailHost">
From: <dtml-var "getObjProperty('bbAdmin',REQUEST)">
To: <dtml-var "getObjProperty('bbAdmin',REQUEST)">
Bcc: <dtml-var bcc>
Subject: [<dtml-var "getTitlealt(REQUEST)">] <dtml-var "unicode(REQUEST.get('newBbmSubject'), 'utf-8').encode('latin-1')">

<dtml-if "lang=='ger'">

Es gibt eine neue Nachricht in Ihrer abonnierten Diskussion. 
Zum Antworten bitte den Link unten benutzen.
---------------------------------------------------------------------
Thema: <dtml-var "unicode(REQUEST.get('newBbmSubject'), 'utf-8').encode('latin-1')">
Nachricht: 

<dtml-var "unicode(REQUEST.get('newBbmBody'), 'utf-8').encode('latin-1')">
---------------------------------------------------------------------
Auf diese Nachricht antworten: 
<dtml-var "url_append_params(URL,{'newTabSheet':'displayReply','bbmId':REQUEST.get('bbmId'),'boardId':'%s_%s'%(id,aq_parent.id)})">
---------------------------------------------------------------------
Abmelden von der Benachrichtigung ueber neue Nachrichten: 
<dtml-var "url_append_params(URL,{'newTabSheet':'displayUnsubscriptionForm','bbmId':REQUEST.get('bbmId'),'boardId':'%s_%s'%(id,aq_parent.id)})">
---------------------------------------------------------------------
<dtml-else>

A reader sent a message to your subscribed thread. 
To answer this message please use the link below.
---------------------------------------------------------------------
Subject: <dtml-var "unicode(REQUEST.get('newBbmSubject'), 'utf-8').encode('latin-1')">
The message: 

<dtml-var "unicode(REQUEST.get('newBbmBody'), 'utf-8').encode('latin-1')">
---------------------------------------------------------------------
Answer this message: 
<dtml-var "url_append_params(URL,{'newTabSheet':'displayReply','bbmId':REQUEST.get('bbmId'),'boardId':'%s_%s'%(id,aq_parent.id)})">
---------------------------------------------------------------------
To unsubscribe from notification for coming replies: 
<dtml-var "url_append_params(URL,{'newTabSheet':'displayUnsubscriptionForm','bbmId':REQUEST.get('bbmId'),'boardId':'%s_%s'%(id,aq_parent.id)})">
---------------------------------------------------------------------
</dtml-if>

</dtml-sendmail>

<dtml-call "REQUEST.set('message',getLangStr('bbMsgNotificationSendOk',lang)%(_.len(isSent)))">

<dtml-except>
    <dtml-call "REQUEST.set('message',getLangStr('bbMsgNotificationSendNot',lang))">
</dtml-try>

<dtml-return message>
<!-- // EO sendNotification // -->]]></item>
<item key="default"></item>
<item key="id"><![CDATA[sendNotification]]></item>
<item key="keys" type="list"><list>
</list>
</item>
<item key="mandatory" type="int">0</item>
<item key="multilang" type="int">0</item>
<item key="name"><![CDATA[Send Notification]]></item>
<item key="repetitive" type="int">0</item>
<item key="type"><![CDATA[method]]></item>
</dictionary>
</item>
<item type="dictionary"><dictionary>
<item key="custom"><![CDATA[<!-- // BO insertNotification // -->

<dtml-try>
    <dtml-if "REQUEST.has_key('newBbmEmail') and REQUEST.get('newBbmEmail').strip()!=''">
        <dtml-with bbNotifications>
            <dtml-call "REQUEST.set('newRow',{
                'bbnId': getNewId(),
                'bbnEmail': REQUEST.get('newBbmEmail').strip(),
                'bbnMsg': REQUEST.get('bbmId'),
                'bbnDateTime': parseLangFmtDate(getLangFmtDate(ZopeTime(),lang),lang)
                })">
            <dtml-call "resNtf.append(newRow)">
            <dtml-call "setObjStateModified(REQUEST)">
            <dtml-call "setObjProperty('records',resNtf,lang)">
            <dtml-call "onChangeObj(REQUEST,forced=1)">
        </dtml-with>
        <dtml-call "REQUEST.set('message',getLangStr('bbMsgNotificationInsertOk',lang)%(getLangFmtDate(ZopeTime(),lang)))">
    <dtml-else>
        <dtml-call "REQUEST.set('message',getLangStr('bbMsgNotificationInsertRetry',lang))">
    </dtml-if>
<dtml-except>
    <dtml-call "REQUEST.set('message',getLangStr('bbMsgNotificationInsertNot',lang))">
</dtml-try>

<dtml-return message>

<!-- // EO insertNotification // -->]]></item>
<item key="default"></item>
<item key="id"><![CDATA[insertNotification]]></item>
<item key="keys" type="list"><list>
</list>
</item>
<item key="mandatory" type="int">0</item>
<item key="multilang" type="int">0</item>
<item key="name"><![CDATA[Insert Notification]]></item>
<item key="repetitive" type="int">0</item>
<item key="type"><![CDATA[method]]></item>
</dictionary>
</item>
<item type="dictionary"><dictionary>
<item key="custom"><![CDATA[<!-- // BO displayUnsubscriptionForm // -->

<form name="registrationForm" method="post">
    <input type="hidden" name="boardId" value="<dtml-var "'%s_%s'%(id,aq_parent.id)">">
    <input type="hidden" name="<dtml-var actionId>" value="unsubscribe">
    <input type="hidden" name="bbmId" value="<dtml-var "REQUEST.get('bbmId')">">
    <table border="0" cellspacing="0" cellpadding="10">
    <tr valign="top"> 
        <td colspan="2"><strong><dtml-var "getLangStr('bbUnsubscribe',lang)"></strong></td>
    </tr>
    <tr valign="top"> 
        <td nowrap valign="top"><strong><dtml-var "getLangStr('bbMyEmail',lang)"></strong>&nbsp;<input type="text" name="name" value="">&nbsp;<input type="submit" value="<dtml-var "getLangStr('bbBtnUnsubscribe',lang)">"></td>
    </tr>
    </table>
</form>

<!-- // EO displayUnsubscriptionForm // -->]]></item>
<item key="default"></item>
<item key="id"><![CDATA[displayUnsubscriptionForm]]></item>
<item key="keys" type="list"><list>
</list>
</item>
<item key="mandatory" type="int">0</item>
<item key="multilang" type="int">0</item>
<item key="name"><![CDATA[Display UnsubscriptionForm]]></item>
<item key="repetitive" type="int">0</item>
<item key="type"><![CDATA[method]]></item>
</dictionary>
</item>
<item type="dictionary"><dictionary>
<item key="custom"><![CDATA[<!-- // BO unsubscribe // -->

<dtml-try>
    <dtml-call "REQUEST.set('resMsg',bbMessages.getObjProperty('records',REQUEST))">
    <dtml-call "REQUEST.set('resNtf',bbNotifications.getObjProperty('records',REQUEST))">
<dtml-except>
    <dtml-call "REQUEST.set('resMsg',{})">
    <dtml-call "REQUEST.set('resNtf',{})">
</dtml-try>

<dtml-call "REQUEST.set('subsEmail',name.strip())">
<dtml-call "REQUEST.set('exist',[])">

<!-- ##### find subscriber in given thread ##### -->
<dtml-in "tree_parents(resMsg,'bbmId','bbmBbmId',bbmId,1)" mapping>
    <dtml-call "REQUEST.set('foo',filter_list(resNtf,'bbnMsg',bbmId,'=='))">
    <dtml-call "REQUEST.set('exist',exist+filter_list(foo,'bbnEmail',subsEmail,'=='))">
</dtml-in>

<!-- ##### remove subscriber from given thread ##### -->
<dtml-with bbNotifications>
    <dtml-if "_.len(exist)>0">
        <dtml-in exist mapping>
            <dtml-call "setObjStateModified(REQUEST)">
            <dtml-call "setObjProperty('records',filter_list(getObjProperty('records',REQUEST),'bbnId',bbnId,'!='),lang)">
            <dtml-call "onChangeObj(REQUEST)">
        </dtml-in>
        <dtml-call "REQUEST.set('message',getLangStr('bbMsgUnsubscribeOk',lang))">
    <dtml-else>
        <dtml-call "REQUEST.set('message',getLangStr('bbMsgUnsubcribeNot',lang))">
    </dtml-if>
</dtml-with>

<div style="color:maroon; background-color: white; border: solid 1px black; padding: 4px;">
    <dtml-var message>
</div>

<!-- // EO unsubscribe // -->]]></item>
<item key="default"></item>
<item key="id"><![CDATA[unsubscribe]]></item>
<item key="keys" type="list"><list>
</list>
</item>
<item key="mandatory" type="int">0</item>
<item key="multilang" type="int">0</item>
<item key="name"><![CDATA[Unsubscribe]]></item>
<item key="repetitive" type="int">0</item>
<item key="type"><![CDATA[method]]></item>
</dictionary>
</item>
<item type="dictionary"><dictionary>
<item key="custom"><![CDATA[<!-- // BO insertNew // -->

<dtml-try>
    <dtml-call "REQUEST.set('resMsg',bbMessages.getObjProperty('records',REQUEST))">
<dtml-except>
    <dtml-call "REQUEST.set('resMsg',{})">
</dtml-try>
 
<dtml-comment>    
<!-- +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-
     +-+-  Insert Message
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+- -->
</dtml-comment>

<dtml-if "REQUEST.get('boardId','') == '%s_%s'%(id,aq_parent.id) and REQUEST.get('btn','')==getLangStr('bbBtnSend',lang)">

    <dtml-with bbMessages>
        <dtml-call "REQUEST.set('newRow',{
            'bbmId': getNewId(),
            'bbmSubject': REQUEST.get('newBbmSubject').strip(),
            'bbmAuthor': REQUEST.get('newBbmAuthor').strip(),
            'bbmEmail': REQUEST.get('newBbmEmail').strip(),
            'bbmDateTime':parseLangFmtDate(getLangFmtDate(ZopeTime(),lang),lang),
            'bbmBody': REQUEST.get('newBbmBody').strip(),
            'bbmFile': formatObjAttrValue(getObjAttr('bbmFile'),REQUEST.form.get('newBbmFile',_.None),lang),	
            'bbmBbmId': REQUEST.get('newBbmBbmId'),
            })">
        <dtml-call "resMsg.append(newRow)">
        <dtml-call "setObjStateModified(REQUEST)">
        <dtml-call "setObjProperty('records',resMsg,lang)">
        <dtml-call "onChangeObj(REQUEST,forced=1)">
    </dtml-with>
    
    <dtml-let expires="(_.DateTime() + 365).toZone('GMT').rfc822()">
        <dtml-call "RESPONSE.setCookie('__ac_author',newRow['bbmAuthor'],path='/',expires=expires)">
        <dtml-call "RESPONSE.setCookie('__ac_email',newRow['bbmEmail'],path='/',expires=expires)">
    </dtml-let>

    <dtml-call "REQUEST.set('bbmId',newRow['bbmId'])">

    <div style="color:maroon; background-color: white; border: solid 1px black; padding: 4px;">
        <dtml-try>
        <dtml-var "getLangStr('bbMsgMessageInsertOk',lang)%getLangFmtDate(ZopeTime(),lang)">
        <dtml-except>
        </dtml-try>
    </div>
    
    <dtml-call "RESPONSE.redirect('?newTabSheet=displayOverview&boardId=%s_%s'%(id,aq_parent.id))">

</dtml-if>

<!-- +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-
     +-+-  Insert Message Form
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+- -->
<table width="90%" border="0" cellspacing="0" cellpadding="0">
<form method="post" enctype="multipart/form-data">
<input type="hidden" name="boardId" value="<dtml-var "'%s_%s'%(id,aq_parent.id)">">
<input type="hidden" name="bbmId">
<input type="hidden" name="newBbmBbmId">
<input type="hidden" name="newTabSheet" value="insertNew">
<tr style="background-color: #C8DBE2;">
    <td>
        <table width="100%" border="0" cellspacing="1" cellpadding="1" class="neutralColorWhite">
        <tr style="background-color: #C8DBE2;">
            <td><strong><dtml-var "getLangStr('bbInsertTopic',lang)"></strong></td>
            <td align="right" style="width:83px;"><input type="submit" style="width:80px;font-size:11px;" name="btn" value="<dtml-var "getLangStr('bbBtnSend',lang)">"></td>
        </tr>
        </table>
    </td>
</tr>
<tr valign="middle">
    <td>
        <table width="100%" class="neutralColorWhite" border="0" cellspacing="0" cellpadding="3">
        <tr>
            <td><strong><dtml-var "getLangStr('bbSubject',lang)"></strong></td>
            <td><input type="text" name="newBbmSubject" value="" size="40"></td>
        </tr>
        <tr valign="middle">
            <td><strong><dtml-var "getLangStr('bbAuthor',lang)"></strong></td>
            <td><input type="text" name="newBbmAuthor" value="" size="40"></td>
        </tr>
        <tr valign="middle">
            <td><strong>eMail</strong></td>
            <td><input type="text" name="newBbmEmail" value="" size="40">
        </td>
        <tr valign="middle">
            <td></td>
            <td><input type="checkbox" name="newBbnEmailNtf" value="1">&nbsp;<dtml-var "getLangStr('bbSendNotification',lang)"></td>
        </tr>
        <tr valign="middle">
            <td colspan="2"><textarea name="newBbmBody" wrap="on" cols="39" rows="15" style="width:100%"></textarea></td>
        </tr>
        <tr valign="middle">
            <td><img src="<dtml-var "getObjProperty('mail_appendix',REQUEST).getHref(REQUEST)">" alt="" border="0" align="absmiddle" /><strong> <dtml-var "getLangStr('bbFile',lang)"></strong></td>
            <td><input type="file" name="newBbmFile" size="19" style="font-size:11px;"></td>
        </tr>
        </table>
    </td>
</tr>
</form>
</table>

<!-- // EO insertNew // -->]]></item>
<item key="default"></item>
<item key="id"><![CDATA[insertNew]]></item>
<item key="keys" type="list"><list>
</list>
</item>
<item key="mandatory" type="int">0</item>
<item key="multilang" type="int">0</item>
<item key="name"><![CDATA[insertNew]]></item>
<item key="repetitive" type="int">0</item>
<item key="type"><![CDATA[method]]></item>
</dictionary>
</item>
<item type="dictionary"><dictionary>
<item key="custom"><![CDATA[<!-- // BO onChangeObjEvt // -->

<!-- // EO onChangeObjEvt // -->]]></item>
<item key="default"></item>
<item key="id"><![CDATA[onChangeObjEvt]]></item>
<item key="keys" type="list"><list>
</list>
</item>
<item key="mandatory" type="int">0</item>
<item key="multilang" type="int">0</item>
<item key="name"><![CDATA[onChangeObjEvt]]></item>
<item key="repetitive" type="int">0</item>
<item key="type"><![CDATA[method]]></item>
</dictionary>
</item>
<item type="dictionary"><dictionary>
<item key="custom"><![CDATA[<!-- // BO insertRating // -->

<dtml-try>
    <dtml-if "REQUEST.has_key('newBbrRate')">
        <dtml-with bbRatings>
            <dtml-call "REQUEST.set('newRow',{
                'bbrId': getNewId(),
                'bbrMsg': REQUEST.get('bbmId'),
                'bbrRate': REQUEST.get('newBbrRate'),
                'bbrExpl': REQUEST.get('newBbrExpl'),
                'bbrDateTime': parseLangFmtDate(getLangFmtDate(ZopeTime(),lang),lang)
                })">
            <dtml-call "resRtg.append(newRow)">
            <dtml-call "setObjStateModified(REQUEST)">
            <dtml-call "setObjProperty('records',resRtg,lang)">
            <dtml-call "onChangeObj(REQUEST,forced=1)">
        </dtml-with>
        <dtml-call "REQUEST.set('message',getLangStr('bbMsgRatingInsertOk',lang)%(getLangFmtDate(ZopeTime(),lang)))">
    <dtml-else>
        <dtml-call "REQUEST.set('message',getLangStr('bbMsgRatingInsertRetry',lang))">
    </dtml-if>
<dtml-except>
    <dtml-call "REQUEST.set('message',getLangStr('bbMsgRatingInsertNot',lang))">
</dtml-try>

<dtml-return message>

<!-- // EO insertRating // -->]]></item>
<item key="default"></item>
<item key="id"><![CDATA[insertRating]]></item>
<item key="keys" type="list"><list>
</list>
</item>
<item key="mandatory" type="int">0</item>
<item key="multilang" type="int">0</item>
<item key="name"><![CDATA[insertRating]]></item>
<item key="repetitive" type="int">0</item>
<item key="type"><![CDATA[method]]></item>
</dictionary>
</item>
<item type="dictionary"><dictionary>
<item key="custom"><![CDATA[/* BO f_css_defaults */

/* EO f_css_defaults */]]></item>
<item key="default"></item>
<item key="id"><![CDATA[f_css_defaults]]></item>
<item key="keys" type="list"><list>
</list>
</item>
<item key="mandatory" type="int">0</item>
<item key="multilang" type="int">0</item>
<item key="name"><![CDATA[CSS]]></item>
<item key="repetitive" type="int">0</item>
<item key="type"><![CDATA[method]]></item>
</dictionary>
</item>
</list>
</item>
<item key="access" type="dictionary"><dictionary>
<item key="edit" type="list"><list>
<item><![CDATA[ZMSAdministrator]]></item>
<item><![CDATA[ZMSAuthor]]></item>
<item><![CDATA[ZMSEditor]]></item>
</list>
</item>
<item key="insert" type="list"><list>
<item><![CDATA[ZMSAdministrator]]></item>
<item><![CDATA[ZMSAuthor]]></item>
<item><![CDATA[ZMSEditor]]></item>
</list>
</item>
</dictionary>
</item>
<item key="acquired" type="int">0</item>
<item key="name"><![CDATA[Bulletin-Board]]></item>
<item key="package"><![CDATA[com.zms.discussions]]></item>
<item key="type"><![CDATA[ZMSObject]]></item>
</dictionary>
</item>
</dictionary>
</item>
<item type="dictionary"><dictionary>
<item key="dtml"><![CDATA[<!-- BO bodyContentZMSCustom_BulletinBoardMessages -->

  <h2><dtml-var "getTitlealt(REQUEST)"></h2>
  <p class="description"><dtml-var "_.len(getObjProperty(getMetaobj(meta_id)['attrs'][0]['id'],REQUEST))"> <dtml-var "getLangStr('ATTR_RECORDS',lang)"></p>

<!-- EO bodyContentZMSCustom_BulletinBoardMessages -->]]></item>
<item key="enabled" type="int">0</item>
<item key="key"><![CDATA[BulletinBoardMessages]]></item>
<item key="value" type="dictionary"><dictionary>
<item key="__obj_attrs__" type="list"><list>
<item type="dictionary"><dictionary>
<item key="custom" type="int">0</item>
<item key="default"></item>
<item key="id"><![CDATA[records]]></item>
<item key="keys" type="list"><list>
</list>
</item>
<item key="mandatory" type="int">1</item>
<item key="multilang" type="int">0</item>
<item key="name"><![CDATA[Records]]></item>
<item key="repetitive" type="int">0</item>
<item key="type"><![CDATA[list]]></item>
</dictionary>
</item>
<item type="dictionary"><dictionary>
<item key="custom" type="int">0</item>
<item key="default"></item>
<item key="id"><![CDATA[bbmId]]></item>
<item key="keys" type="list"><list>
</list>
</item>
<item key="mandatory" type="int">1</item>
<item key="multilang" type="int">0</item>
<item key="name"><![CDATA[Id]]></item>
<item key="repetitive" type="int">0</item>
<item key="type"><![CDATA[identifier]]></item>
</dictionary>
</item>
<item type="dictionary"><dictionary>
<item key="custom" type="file">
<data content_type="image/gif" filename="ico_message.gif" type="file">47494638396112001000b30000fcd7650000000808084242422222223c3c3c0f0f0f5555555a5a5a282828333333191919ffffff00000000000000000021f9040100000c002c000000001200100000044590c949abbdb88e518a22d981204069128b511d66eb0ad360066560dbb324bb7c2d15b3db0d40234a12bd5e6042a8e170b98921199d088850e7b222804984986d664c2e6722003b</data></item>
<item key="default"></item>
<item key="id"><![CDATA[icon]]></item>
<item key="keys" type="list"><list>
</list>
</item>
<item key="mandatory" type="int">0</item>
<item key="multilang" type="int">0</item>
<item key="name"><![CDATA[Icon]]></item>
<item key="repetitive" type="int">0</item>
<item key="type"><![CDATA[resource]]></item>
</dictionary>
</item>
<item type="dictionary"><dictionary>
<item key="custom" type="int">1</item>
<item key="default"></item>
<item key="id"><![CDATA[bbmSubject]]></item>
<item key="keys" type="list"><list>
</list>
</item>
<item key="mandatory" type="int">1</item>
<item key="multilang" type="int">0</item>
<item key="name"><![CDATA[Subject]]></item>
<item key="repetitive" type="int">0</item>
<item key="type"><![CDATA[string]]></item>
</dictionary>
</item>
<item type="dictionary"><dictionary>
<item key="custom" type="int">1</item>
<item key="default"></item>
<item key="id"><![CDATA[bbmAuthor]]></item>
<item key="keys" type="list"><list>
</list>
</item>
<item key="mandatory" type="int">1</item>
<item key="multilang" type="int">0</item>
<item key="name"><![CDATA[Author]]></item>
<item key="repetitive" type="int">0</item>
<item key="type"><![CDATA[string]]></item>
</dictionary>
</item>
<item type="dictionary"><dictionary>
<item key="custom" type="int">1</item>
<item key="default"></item>
<item key="id"><![CDATA[bbmDateTime]]></item>
<item key="keys" type="list"><list>
</list>
</item>
<item key="mandatory" type="int">1</item>
<item key="multilang" type="int">0</item>
<item key="name"><![CDATA[Date/Time]]></item>
<item key="repetitive" type="int">0</item>
<item key="type"><![CDATA[datetime]]></item>
</dictionary>
</item>
<item type="dictionary"><dictionary>
<item key="custom" type="int">0</item>
<item key="default"></item>
<item key="id"><![CDATA[bbmEmail]]></item>
<item key="keys" type="list"><list>
</list>
</item>
<item key="mandatory" type="int">0</item>
<item key="multilang" type="int">0</item>
<item key="name"><![CDATA[e-Mail]]></item>
<item key="repetitive" type="int">0</item>
<item key="type"><![CDATA[string]]></item>
</dictionary>
</item>
<item type="dictionary"><dictionary>
<item key="custom" type="int">0</item>
<item key="default"></item>
<item key="id"><![CDATA[bbmBody]]></item>
<item key="keys" type="list"><list>
</list>
</item>
<item key="mandatory" type="int">0</item>
<item key="multilang" type="int">0</item>
<item key="name"><![CDATA[Body]]></item>
<item key="repetitive" type="int">0</item>
<item key="type"><![CDATA[text]]></item>
</dictionary>
</item>
<item type="dictionary"><dictionary>
<item key="custom" type="int">0</item>
<item key="default"></item>
<item key="id"><![CDATA[bbmFile]]></item>
<item key="keys" type="list"><list>
</list>
</item>
<item key="mandatory" type="int">0</item>
<item key="multilang" type="int">0</item>
<item key="name"><![CDATA[File]]></item>
<item key="repetitive" type="int">0</item>
<item key="type"><![CDATA[file]]></item>
</dictionary>
</item>
<item type="dictionary"><dictionary>
<item key="custom" type="int">0</item>
<item key="default"></item>
<item key="id"><![CDATA[bbmBbmId]]></item>
<item key="keys" type="list"><list>
</list>
</item>
<item key="mandatory" type="int">0</item>
<item key="multilang" type="int">0</item>
<item key="name"><![CDATA[In reply to]]></item>
<item key="repetitive" type="int">0</item>
<item key="type"><![CDATA[BulletinBoardMessages]]></item>
</dictionary>
</item>
</list>
</item>
<item key="access" type="dictionary"><dictionary>
<item key="edit" type="list"><list>
<item><![CDATA[ZMSAdministrator]]></item>
<item><![CDATA[ZMSAuthor]]></item>
<item><![CDATA[ZMSEditor]]></item>
</list>
</item>
<item key="insert" type="list"><list>
<item><![CDATA[ZMSAdministrator]]></item>
<item><![CDATA[ZMSAuthor]]></item>
<item><![CDATA[ZMSEditor]]></item>
</list>
</item>
</dictionary>
</item>
<item key="acquired" type="int">0</item>
<item key="name"><![CDATA[Messages]]></item>
<item key="package"><![CDATA[com.zms.discussions]]></item>
<item key="type"><![CDATA[ZMSRecordSet]]></item>
</dictionary>
</item>
</dictionary>
</item>
<item type="dictionary"><dictionary>
<item key="dtml"><![CDATA[<!-- BO bodyContentZMSCustom_BulletinBoardNotifications -->

  <h2><dtml-var "getTitlealt(REQUEST)"></h2>
  <p class="description"><dtml-var "_.len(getObjProperty(getMetaobj(meta_id)['attrs'][0]['id'],REQUEST))"> <dtml-var "getLangStr('ATTR_RECORDS',lang)"></p>

<!-- EO bodyContentZMSCustom_BulletinBoardNotifications -->]]></item>
<item key="enabled" type="int">0</item>
<item key="key"><![CDATA[BulletinBoardNotifications]]></item>
<item key="value" type="dictionary"><dictionary>
<item key="__obj_attrs__" type="list"><list>
<item type="dictionary"><dictionary>
<item key="custom" type="int">0</item>
<item key="default"></item>
<item key="id"><![CDATA[records]]></item>
<item key="keys" type="list"><list>
</list>
</item>
<item key="mandatory" type="int">1</item>
<item key="multilang" type="int">0</item>
<item key="name"><![CDATA[records]]></item>
<item key="repetitive" type="int">0</item>
<item key="type"><![CDATA[list]]></item>
</dictionary>
</item>
<item type="dictionary"><dictionary>
<item key="custom" type="int">0</item>
<item key="default"></item>
<item key="id"><![CDATA[bbnId]]></item>
<item key="keys" type="list"><list>
</list>
</item>
<item key="mandatory" type="int">1</item>
<item key="multilang" type="int">0</item>
<item key="name"><![CDATA[Id]]></item>
<item key="repetitive" type="int">0</item>
<item key="type"><![CDATA[identifier]]></item>
</dictionary>
</item>
<item type="dictionary"><dictionary>
<item key="custom" type="int">1</item>
<item key="default"></item>
<item key="id"><![CDATA[bbnEmail]]></item>
<item key="keys" type="list"><list>
</list>
</item>
<item key="mandatory" type="int">1</item>
<item key="multilang" type="int">0</item>
<item key="name"><![CDATA[Email]]></item>
<item key="repetitive" type="int">0</item>
<item key="type"><![CDATA[string]]></item>
</dictionary>
</item>
<item type="dictionary"><dictionary>
<item key="custom" type="int">1</item>
<item key="default"></item>
<item key="id"><![CDATA[bbnMsg]]></item>
<item key="keys" type="list"><list>
</list>
</item>
<item key="mandatory" type="int">0</item>
<item key="multilang" type="int">0</item>
<item key="name"><![CDATA[Msg]]></item>
<item key="repetitive" type="int">0</item>
<item key="type"><![CDATA[BulletinBoardMessages]]></item>
</dictionary>
</item>
<item type="dictionary"><dictionary>
<item key="custom" type="int">1</item>
<item key="default"></item>
<item key="id"><![CDATA[bbnDateTime]]></item>
<item key="keys" type="list"><list>
</list>
</item>
<item key="mandatory" type="int">0</item>
<item key="multilang" type="int">0</item>
<item key="name"><![CDATA[Date/Time]]></item>
<item key="repetitive" type="int">0</item>
<item key="type"><![CDATA[datetime]]></item>
</dictionary>
</item>
<item type="dictionary"><dictionary>
<item key="custom" type="file">
<data content_type="image/gif" filename="ico_notification.gif" type="file">47494638396112001000f70000ffffffc20000980000fdfdfcfaf0f0fefefeca00009900005f2900ab000072400a7b4c1ed3c4b6ecd0d0a31b1bab2121773209ddd0c4b83535c05255ad3232b41111f9f7f56f3d0c862c12ecc9c9efd2d2e4bcbc9c7b5afefdfdeed3d3b20000b60101733f0df4dedeae0b0cb60000c26868aa0000e100008a5f33a10606cab49efefcfca1000079390ce7babacb998fa60000865d307a4515b19478eee9e3d5c6b7c90000602c00c5000093351e774412a20000f8f5f2833a11a687699d0b00f9f1f1692c00c00000ad0f0f9a0000b59b80622800a90000ae0000a006066b3904eee7e18b1f05f6f3f0ac2727b39980bd5454fcfbfab244449f7c5a784f1c926b46fcf7f77e5328e3dad0f7f3f0b54343f5dedf865c33b82023c86a6ab9a087cb62629c0000fbf9f8b50100c600009f0000d30000d10000cb0000d5c5b5ba0000bd0000ab0600683100e9cecea70000eccece613000b89e83fcf8f8960101d89595de0000774814ce7777a48261cb8181c26666e2dacebc0000b4997ef7ebebfffefee6b2b2a20a01713d09b31b1bad0000ac7e64bb0000d98f8ffdfafaffffff00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000021f9040100008a002c000000001200100000089e0015091c48b0204139545e6cc9e0c1a0c13c71307421e4a4c4068703b1dc8090800c92140e4460544443810c366784143aa0059106874b5028f96120c007163b2a48f0b2c74d411f089804b04102c6910027cc2469509001821e87d0a8315106879d3e780c468811441088110fa44009349283911c13eab81839f0491b436c0b7ed131252ec1340baef0b13b904b08157c0556193423b0223f178ac40d08003b</data></item>
<item key="default"></item>
<item key="id"><![CDATA[icon]]></item>
<item key="keys" type="list"><list>
</list>
</item>
<item key="mandatory" type="int">0</item>
<item key="multilang" type="int">0</item>
<item key="name"><![CDATA[icon]]></item>
<item key="repetitive" type="int">0</item>
<item key="type"><![CDATA[resource]]></item>
</dictionary>
</item>
</list>
</item>
<item key="access" type="dictionary"><dictionary>
<item key="edit" type="list"><list>
<item><![CDATA[ZMSAdministrator]]></item>
<item><![CDATA[ZMSAuthor]]></item>
<item><![CDATA[ZMSEditor]]></item>
</list>
</item>
<item key="insert" type="list"><list>
<item><![CDATA[ZMSAdministrator]]></item>
<item><![CDATA[ZMSAuthor]]></item>
<item><![CDATA[ZMSEditor]]></item>
</list>
</item>
</dictionary>
</item>
<item key="acquired" type="int">0</item>
<item key="name"><![CDATA[Notifications]]></item>
<item key="package"><![CDATA[com.zms.discussions]]></item>
<item key="type"><![CDATA[ZMSRecordSet]]></item>
</dictionary>
</item>
</dictionary>
</item>
</list>
